# MACD Analysis å…­ä¹¦èåˆç­–ç•¥ â€” å®Œæ•´æŠ€æœ¯è§„æ ¼

> ç‰ˆæœ¬: v9.0.1 (B1b + P13 + P20 + P24 + Anti-Squeeze)
> ç¼–å†™æ—¶é—´: 2026-02-15 18:47:20 CST (åŒ—äº¬æ—¶é—´)
> æœ€åæ›´æ–°: 2026-02-15 v9.0.1 å›æµ‹éªŒè¯ (å« v5 å®Œæ•´å›æµ‹ã€IS PF<1.0 å‘ç°)
> ç”Ÿäº§é…ç½®: live_config.py v5 (`STRATEGY_VERSION=v5`)
> æ ‡çš„: ETH/USDT æ°¸ç»­åˆçº¦ + ç°è´§
> ä¸»å‘¨æœŸ: 1h | å†³ç­–å‘¨æœŸ: 15m + 1h + 4h + 24h
>
> **âš ï¸ v9.0.1 å…³é”®å‘ç°**: v5 ç”Ÿäº§é…ç½® IS PF=0.90 (<1.0)ã€‚B1b è¯¯æ€ IS ç›ˆåˆ© neutral short, P24 è¿‡åº¦æˆªæ–­ trend short åˆ©æ¶¦ã€‚OOS å› æ—  short äº¤æ˜“æ— æ³•éªŒè¯ v9 æ–°ç‰¹æ€§ã€‚æ–°å¢ P33/P34/P35 ç´§æ€¥ä¼˜åŒ–é¡¹ã€‚

---

## ä¸€ã€ç­–ç•¥æ¶æ„æ€»è§ˆ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ•°æ®é‡‡é›†å±‚ (binance_fetcher.py)                        â”‚
â”‚                                                                          â”‚
â”‚  ç°è´§OHLCV + taker_buy_quote (å¾®ç»“æ„æº)                                  â”‚
â”‚  æ”¯æŒ: 1m/3m/5m/10m/15m/30m/1h/2h/3h/4h/6h/8h/12h/16h/24h              â”‚
â”‚  ç¼“å­˜: data/klines/{symbol}/{interval}.parquet                           â”‚
â”‚  åˆçº¦æ•°æ®: mark_price, funding_rate, open_interest (å¯é€‰, å›é€€åˆ°ä»£ç†)     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æŠ€æœ¯æŒ‡æ ‡å±‚ (indicators.py)                             â”‚
â”‚                                                                          â”‚
â”‚  MACD(12/26/9) + å¿«é€ŸMACD(5/10/5) + KDJ(9/3/3) + CCI(14) + RSI(6/12)  â”‚
â”‚  MA: SMA/EMA/WMA (5,10,20,30,48,60,120,240)                            â”‚
â”‚  ç»“æ„: é¡¶åº•æ£€æµ‹(3bar/5bar) + è¶‹åŠ¿æ®µè¯†åˆ« + MACDæŸ±ç»„åˆ†æ + é‡‘æ­»å‰æ£€æµ‹     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  å…­ä¹¦ä¿¡å·å±‚ (6 ç­–ç•¥æ¨¡å—, æ¯ä¸ªTFç‹¬ç«‹è®¡ç®—)                   â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚èƒŒç¦»(DIV)â”‚ â”‚å‡çº¿(MA) â”‚ â”‚èœ¡çƒ›(CS) â”‚ â”‚å¸ƒæ—(BB) â”‚ â”‚é‡ä»·  â”‚ â”‚KDJ/æµ·é¾Ÿ â”‚ â”‚
â”‚  â”‚dâ‰ˆ-0.04  â”‚ â”‚dâ‰ˆ+0.38  â”‚ â”‚dâ‰ˆ+0.40  â”‚ â”‚dâ‰ˆ+0.15  â”‚ â”‚dâ‰ˆ0.22â”‚ â”‚dâ‰ˆ+0.42  â”‚ â”‚
â”‚  â”‚(neutral)â”‚ â”‚(neutral)â”‚ â”‚(neutral)â”‚ â”‚(neutral)â”‚ â”‚      â”‚ â”‚(neutral)â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â””â”€â”€â”¬â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜ â”‚
â”‚       â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜           â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜         â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜      â”‚
â”‚        base_score(70%)         veto/bonus å±‚          veto/bonus        â”‚
â”‚  (div*0.55+kdj*0.15+ma*0.30) 2+æœ¬åå‘â‰¥25â†’Ã—0.30    åŒå‘â‰¥15â†’+bonus      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ sell_score(SS), buy_score(BS) per TF
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚               å¤šå‘¨æœŸè”åˆå†³ç­–å±‚ (multi_tf_consensus.py)                    â”‚
â”‚                                                                          â”‚
â”‚  15m(w=3) + 1h(w=8) + 4h(w=15) + 24h(w=28)  æ€»æƒé‡=54                  â”‚
â”‚  â†’ åŠ æƒå…±è¯† â†’ å…±æŒ¯é“¾æ£€æµ‹(â‰¥3çº§+4h=å¼º) â†’ å¤§å°TFåå‘è¡°å‡ â†’ å†³ç­–çŸ©é˜µ(A-F)  â”‚
â”‚  â†’ Regimeé©±åŠ¨åŠ¨æ€æƒé‡: high_volâ†’å°TFÃ—0.6, trendâ†’å¤§TFÃ—1.25              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚ weighted_ss, weighted_bs, signal_meta
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   å¾®ç»“æ„å åŠ  + åŒå¼•æ“åˆ‡æ¢                                 â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚å¾®ç»“æ„(åŸºå·®/OI/    â”‚  â”‚ åŒå¼•æ“é€‰æ‹©:       â”‚  â”‚ Vol-Targeting:        â”‚  â”‚
â”‚  â”‚èµ„é‡‘è´¹ç‡ä»£ç†)      â”‚  â”‚ trend: é¡ºåŠ¿å…¥åœº   â”‚  â”‚ margin *= target/     â”‚  â”‚
â”‚  â”‚â†’ SS/BS Â±8~10%    â”‚  â”‚ reversion: åè½¬   â”‚  â”‚ realized_vol          â”‚  â”‚
â”‚  â”‚â†’ Anti-Squeeze    â”‚  â”‚ â†’ é˜ˆå€¼/æ æ†è°ƒæ•´   â”‚  â”‚ (0.45x ~ 1.35x)      â”‚  â”‚
â”‚  â”‚  (V9é—¨æ§)        â”‚  â”‚                   â”‚  â”‚                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    é—¨æ§è¿‡æ»¤å±‚ + v9.0 ç®€åŒ–                                  â”‚
â”‚                                                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Regime åŠ¨æ€    â”‚ â”‚Neutral ç»“æ„    â”‚ â”‚ v9.0 B1b: neutral short     â”‚   â”‚
â”‚  â”‚é˜ˆå€¼è°ƒæ•´       â”‚ â”‚è´¨é‡æŠ˜æ‰£        â”‚ â”‚   ç›´æ¥ç¦æ­¢ (neutral:999)    â”‚   â”‚
â”‚  â”‚5ç§å¸‚åœºçŠ¶æ€    â”‚ â”‚0ç¡®è®¤â†’ç¦æ­¢     â”‚ â”‚ å†²çªæŠ˜æ‰£: trend,high_vol    â”‚   â”‚
â”‚  â”‚              â”‚ â”‚1ç¡®è®¤â†’0.05x    â”‚ â”‚ Anti-Squeeze: fr+OI+taker   â”‚   â”‚
â”‚  â”‚              â”‚ â”‚2ç¡®è®¤â†’0.15x    â”‚ â”‚   ä¸‰æ¡ä»¶ç»„åˆâ†’block short    â”‚   â”‚
â”‚  â”‚              â”‚ â”‚3ç¡®è®¤â†’0.50x    â”‚ â”‚                             â”‚   â”‚
â”‚  â”‚              â”‚ â”‚4+ç¡®è®¤â†’1.0x    â”‚ â”‚ [P7/P8] å®éªŒæ€§é—¨æ§(å…³é—­)    â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    æ‰§è¡Œå¼•æ“ (FuturesEngine)                               â”‚
â”‚                                                                          â”‚
â”‚  ä¿¡å·åœ¨ bar[i-1] close è®¡ç®— â†’ bar[i] open æ‰§è¡Œ (å»¶è¿Ÿä¸€æ ¹, æ¶ˆé™¤å‰è§†)      â”‚
â”‚  è´¹ç”¨: Taker 0.05% + Slippage 0.1% + Funding Â±0.01%/8h                  â”‚
â”‚  ä¿è¯é‡‘: é€ä»“éš”ç¦», æœ€å¤§5xæ æ†, å¯ç”¨=usdt-frozen                         â”‚
â”‚  é€€å‡º: P24 Regime-Adaptive SL (trend:-15%, high_vol:-12%) + TP(+60%/+40%)â”‚
â”‚       + P13è¿ç»­è¿½è¸ªæ­¢ç›ˆ(åˆ©æ¶¦â‰¥5%å¯åŠ¨, å›æ’¤å®¹å¿60%â†’30%æ¸è¿›æ”¶ç´§)           â”‚
â”‚       + P20ç©ºå¤´è¿½è¸ªæ”¶ç´§(60%â†’40%) + PartialTP1/TP2                       â”‚
â”‚  é£æ§: åæ‰‹â‰¥8bar, å†·å´6bar, å¼ºå¹³å6Ã—å†·å´, è¿ç»­æ­¢æŸ2Ã—å†·å´                 â”‚
â”‚  è¡ç”Ÿå“æ•°æ®: Mark Priceå¼ºå¹³ + Funding Rateæˆæœ¬ + OIæ‹¥æŒ¤åº¦æ£€æµ‹             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## äºŒã€å…­ç»´ä¿¡å·è®¡ç®—

æ¯ä¸ªæ—¶é—´æ¡†æ¶ç‹¬ç«‹è®¡ç®— 6 ç»´ä¿¡å·ï¼Œäº§å‡º `sell_score` å’Œ `buy_score`ï¼ˆ0~100 èŒƒå›´ï¼‰ã€‚

### 2.1 èƒŒç¦»ä¿¡å· (Divergence) â€” div_weight=0.55

åŸºäº MACD çš„é¡¶åº•èƒŒç¦»æ£€æµ‹ï¼Œè¾“å…¥ä¸»å‘¨æœŸ + 8h è¾…åŠ©å‘¨æœŸã€‚

```python
# ä¿¡å·è®¡ç®—å…¥å£ (signal_core.py:59-64)
lookback = max(60, min(200, len(df) // 3))
div_signals = analyze_signals_enhanced(df, lookback)  # è¿”å› {timestamp: signal_dict}
```

**èƒŒç¦»ç±»å‹ä¸åˆ†å€¼**:
| ç±»å‹ | åˆ†å€¼ | æ¡ä»¶ |
|------|------|------|
| åŒéš”å †é¡¶èƒŒç¦» | +30 | sep_divs_top >= 2 |
| å•éš”å †é¡¶èƒŒç¦» | +18 | sep_divs_top >= 1 æˆ– separated_top >= 1 |
| é¢ç§¯é¡¶èƒŒç¦» | +12 | area_top_div >= 1 |
| DIF é¡¶èƒŒç¦» | +8 | dif_top_div >= 1 |
| ç©ºå¤´åŠ›ç«­ | +18 | exhaust_sell = True |
| é›¶è½´å›å½’é¡¶ | +10 | zero_returns_top >= 1 |
| è¶‹åŠ¿åŠ æˆ | Ã—1.3 | ä¸‹è·Œè¶‹åŠ¿ä¸­ (c5 < c20 Ã— 0.99) |

åº•èƒŒç¦»ç±»ä¼¼ä½†æ–¹å‘ç›¸åï¼Œè¶‹åŠ¿åŠ æˆ Ã—1.2ã€‚

**8h è¾…åŠ©èƒŒç¦»åˆå¹¶** (signal_core.py:295-302):
```python
merged["top"] = main_top * 1.0 + sig_8h_top * 0.5   # åŠ æƒåˆå¹¶
merged["bottom"] = main_bottom * 1.0 + sig_8h_bottom * 0.5
```

**åˆ¤åˆ«åŠ›åˆ†æ** (P4/P16 å®è¯, Cohen's d):

| Regime | DIV | MA | CS | KDJ | BB | VP |
|--------|-----|----|----|-----|----|----|
| neutral | **-0.04** | +0.38 | +0.40 | **+0.42** | +0.15 | +0.22 |
| trend | +0.52 | +0.35 | +0.35 | +0.28 | +0.18 | +0.20 |
| high_vol | +0.12 | +0.32 | +0.25 | **+0.45** | +0.10 | +0.15 |

> **æ ¸å¿ƒé—®é¢˜**: DIV åœ¨ neutral regime (å å…¨éƒ¨äº¤æ˜“ 64%) ä¸­åˆ¤åˆ«åŠ›å‡ ä¹ä¸ºé›¶ (d=-0.04)ï¼Œ
> ä½†å èåˆæƒé‡ 55%ã€‚CS(d=0.40) å’Œ KDJ(d=0.42) æ‰æ˜¯ neutral ä¸­çœŸæ­£æœ‰æ•ˆçš„ç¡®è®¤ä¹¦ã€‚
> å½“å‰é€šè¿‡ç»“æ„æŠ˜æ‰£ç¼“è§£ï¼ˆè§Â§6.2ï¼‰ï¼Œä½†æœ¬è´¨ä¸Šæ˜¯"ä»“ä½è¡¥ä¸"ã€‚

### 2.2 å‡çº¿ä¿¡å· (MA) â€” ma_indicators.py

åŸºäºå¤šæ¡ç§»åŠ¨å¹³å‡çº¿çš„æ’åˆ—ã€äº¤å‰ã€æ–œç‡ç»¼åˆè¯„åˆ†ã€‚

**åŠ å¯†è´§å¸ MA å‘¨æœŸ**:
```python
'15m': [5, 10, 20, 60, 120, 240, 480]    # 1.25h ~ 5 days
'1h':  [5, 10, 20, 30, 60, 120, 240]      # 5h ~ 10 days
'4h':  [5, 10, 20, 30, 60, 120]           # 20h ~ 20 days
```

**è¯„åˆ†ä½“ç³»** (17ä¸ªå½¢æ€ + Granville 8æ³•åˆ™):
- å¤šå¤´æ’åˆ—(MA5>MA10>MA20>MA48): +15
- é‡‘å‰(5/20): +20, é“¶è°·/é‡‘è°·: +25/+35
- å‡ºæ°´è›Ÿé¾™(å¤§é˜³çº¿çªç ´3+å‡çº¿): +30
- å‡çº¿ç²˜åˆçªç ´: +25
- ç©ºå¤´æ’åˆ—æ—¶ sell_score Ã—1.10, å¤šå¤´æ’åˆ—æ—¶ buy_score Ã—1.10

### 2.3 èœ¡çƒ›å›¾ (Candlestick) â€” cs_bonus=0.06

æ£€æµ‹ 30+ ç»å…¸ K çº¿å½¢æ€ (Steve Nison ä½“ç³»)ï¼Œcandlestick_patterns.pyã€‚

**å½¢æ€åˆ†ç±»**:
- **å•æ ¹**: é”¤å­çº¿/åŠäººçº¿/æµæ˜Ÿçº¿/å€’é”¤çº¿/åå­—æ˜Ÿ(4ç§)/çººé”¤çº¿/è…°å¸¦çº¿
- **åŒæ ¹**: åæ²¡/ä¹Œäº‘ç›–é¡¶/åˆºé€/å­•çº¿/å¹³å¤´/åå‡»çº¿/è·³ç©ºçª—å£/åˆ†ç¦»çº¿
- **ä¸‰æ ¹+**: å¯æ˜æ˜Ÿ/é»„æ˜æ˜Ÿ/å¼ƒå©´/ä¸‰åªä¹Œé¸¦/ä¸‰ç™½å…µ/ä¸‰å†…å¤–/ä¸‰è¿›é€€

**å¢å¼º**: é‡èƒ½ç¡®è®¤(Â±30-50%)ã€å…³é”®ä½å¢å¼º(+25%)ã€å½¢æ€å¤±è´¥åè½¬ã€æ—¶é—´è¡°å‡ã€‚

### 2.4 å¸ƒæ—å¸¦ (Bollinger) â€” bb_bonus=0.10

```python
bb_mid = SMA(close, 20)
bb_upper = bb_mid + 2Ïƒ
bb_lower = bb_mid - 2Ïƒ
%B = (close - lower) / (upper - lower)   # >1 è¶…ä¹°, <0 è¶…å–
BandWidth = (upper - lower) / mid Ã— 100
Squeeze: BandWidth < 20th percentile of past 120 bars
```

**ç­–ç•¥æ¨¡å¼**: å‡å€¼å›å½’(è§¦è½¨)ã€è¶‹åŠ¿è·Ÿéš(èµ°å¸¦)ã€ç¼©å£çªç ´ã€%B+æŒ‡æ ‡ç»„åˆã€Wåº•/Mé¡¶æ£€æµ‹ã€‚

### 2.5 é‡ä»· (Volume-Price) â€” vp_bonus=0.08

```python
OBV = Î£(sign(Î”C) Ã— volume)
vol_ratio = volume / SMA(volume, 20)
A/D Line = Î£(CLV Ã— volume)    # CLV = ((C-L)-(H-C))/(H-L)
MFI = 100 - 100/(1 + PosMoney/NegMoney)
```

**Livermore/Wyckoff ç†è®º**: ä»·â†‘é‡â†‘=å¥åº·(+20), ä»·â†‘é‡â†“=è™šå¼±(-15), ä»·â†“é‡â†‘=å¼ºè·Œ(-20), ä»·â†“é‡â†“=æ¯ç«­(+15)ã€‚
æ”¾é‡é«˜æ½®(vol_ratioâ‰¥3.0): Â±35åˆ†ã€‚

### 2.6 KDJ â€” kdj_bonus=0.09, kdj_weight=0.15

```python
RSV = (C - Low_9) / (High_9 - Low_9) Ã— 100
K = EMA(RSV, 1/3), D = EMA(K, 1/3), J = 3K - 2D
```

**ä¹ç« ç­–ç•¥**: è¶…ä¹°è¶…å–(K>80/K<20)ã€é‡‘æ­»å‰(ä½ä½/é«˜ä½)ã€é¡¶åº•èƒŒç¦»ã€KD-MACDæŸ±ç»„ã€å¤šTFå…±æŒ¯ã€‚
- åŒå‘ç¡®è®¤(kdj_sell â‰¥ 15): +kdj_bonus(9%)
- **KDJ timing**: åŒå‘å¼º Ã—1.25, æ­£å¸¸ç¡®è®¤ Ã—1.12, åå‘ Ã—0.70

### 2.7 èåˆæ¨¡å¼: c6_veto_4 (ç”Ÿäº§éƒ¨ç½²)

```python
# signal_core.py:388-420
# åŸºç¡€åˆ†æ•° = 55%èƒŒç¦» + 15%KDJ + 30%å‡çº¿(éšå«, é€šè¿‡ ma_arr_bonus)
base_sell = (div_sell * 0.55 + kdj_sell * 0.15) * ma_arr_bonus_sell

# å¦å†³è®¡æ•°: 4æœ¬ä¹¦(BB/VP/CS/KDJ)ä¸­, åæ–¹å‘â‰¥25çš„æ•°é‡
sell_vetoes = sum(1 for s in [bb_buy, vp_buy, cs_buy, kdj_buy] if s >= 25)

if sell_vetoes >= 2:
    sell_score = base_sell * 0.30   # å¦å†³: å¤§å¹…å‰Šå¼±
else:
    bonus = 0
    if bb_sell >= 15: bonus += 0.10   # bb_bonus
    if vp_sell >= 15: bonus += 0.08   # vp_bonus
    if cs_sell >= 25: bonus += 0.06   # cs_bonus
    if kdj_sell >= 15: bonus += 0.09  # kdj_bonus
    sell_score = base_sell * (1 + bonus)
```

**å…¶ä»–å¯ç”¨èåˆæ¨¡å¼** (signal_core.py, å®éªŒæ€§):
- `c6_veto`: æ—§ç‰ˆ3æœ¬å¦å†³
- `kdj_weighted`: KDJ åŠ¨æ€æƒé‡èåˆ
- `kdj_timing`: KDJ ä¹˜æ•°é©±åŠ¨
- `kdj_gate`: KDJ é—¨æ§
- `regime_adaptive` (P18): Regime é©±åŠ¨çš„åŠ¨æ€æƒé‡çŸ©é˜µ

**å‘é‡åŒ–æ‰¹é‡è®¡ç®—** (signal_core.py:832-977):
`calc_fusion_score_six_batch()` å°†é€ bar å¾ªç¯æ›¿æ¢ä¸º NumPy æ‰¹é‡æ“ä½œï¼Œæ€§èƒ½ä» 41s â†’ <3sã€‚

---

## ä¸‰ã€å¤šå‘¨æœŸè”åˆå†³ç­–

### 3.1 æƒé‡åˆ†é…

```python
TF_WEIGHT = {
    '15m': 3,   # å¾®è§‚å…¥åœºè®¡æ—¶
    '1h':  8,   # æ ¸å¿ƒä¿¡å·æº (primary_tf)
    '4h':  15,  # ä¸­æœŸè¶‹åŠ¿ç¡®è®¤ (å¤§å‘¨æœŸé—¨æ§› â‰¥240min)
    '24h': 28,  # å®è§‚è¶‹åŠ¿é”šå®š
}
# æ€»æƒé‡ = 54, å¤§å‘¨æœŸ(â‰¥4h) å æ¯” 79.6%
```

### 3.2 Regime é©±åŠ¨çš„åŠ¨æ€æƒé‡ (multi_tf_consensus.py:390-409)

```python
if regime_label in ('high_vol_choppy', 'high_vol'):
    # é«˜æ³¢åŠ¨: é™ä½å°å‘¨æœŸæƒé‡(å™ªå£°å¤§), æŠ¬é«˜å¤§å‘¨æœŸ
    if tf_min < 60:   base_w *= 0.6     # 15m æƒé‡é™40%
    if tf_min >= 240:  base_w *= 1.15   # 4h/24h æƒé‡å‡15%
elif regime_label in ('trend', 'low_vol_trend'):
    # è¶‹åŠ¿å¸‚: å¤§å‘¨æœŸæ›´é‡è¦
    if tf_min >= 240:  base_w *= 1.25   # 4h/24h æƒé‡å‡25%
    if tf_min < 60:    base_w *= 0.8    # 15m æƒé‡é™20%
```

### 3.3 åŠ æƒèåˆå…¬å¼

```python
weighted_ss = Î£(tf_scores[tf].ss Ã— effective_weight[tf]) / Î£(effective_weight)
weighted_bs = Î£(tf_scores[tf].bs Ã— effective_weight[tf]) / Î£(effective_weight)
# coverage_min = 0.5 (è‡³å°‘ 50% çš„å†³ç­–TFæœ‰æ•°æ®æ‰å‡ºä¿¡å·)
```

### 3.4 å…±æŒ¯é“¾æ£€æµ‹

æ‰«æç›¸é‚» TF è¿ç»­åŒå‘çš„é“¾æ¡ï¼ˆå…è®¸ 1 ä¸ª hold é—´éš”ï¼‰ï¼š
```python
# å¦‚ 15mâ†’1hâ†’4h å‡çœ‹ç©º â†’ é“¾é•¿3, å«4h+ â†’ å¼ºå…±æŒ¯
if chain_len >= 3 and has_4h_plus:
    boost = 1.0 + chain_len * 0.08   # æ¯çº§ +8%
elif chain_len >= 2:
    boost = 1.0 + chain_len * 0.04   # å¼±å…±æŒ¯æ¯çº§ +4%
```

### 3.5 å¤§å°å‘¨æœŸåå‘è¡°å‡

```python
# å¤§å‘¨æœŸåç©º + å°å‘¨æœŸåå¤š â†’ è¡°å‡ä¹°å…¥ä¿¡å·
if large_ss > large_bs * 1.3 and small_bs > small_ss * 1.3:
    weighted_bs *= 0.5    # ä¹°å…¥ä¿¡å·æ‰“5æŠ˜
    weighted_ss *= 1.15   # å–å‡ºä¿¡å·å¢å¼º
```

### 3.6 å†³ç­–çŸ©é˜µ

| ä¼˜å…ˆçº§ | æ¡ä»¶ | ç»“æœ | strength |
|--------|------|------|----------|
| A | å¤§å°åŒå‘ + 3+çº§å…±æŒ¯é“¾(å«4h+) + net>15 | å¼ºå…¥åœº | 70-100 |
| B | å¤§å‘¨æœŸæ˜ç¡® + å°å‘¨æœŸåŒå‘(æ— å…±æŒ¯é“¾) | ä¸­ç­‰å…¥åœº | 50-70 |
| C | å¤§å°å‘¨æœŸåå‘ | ä¸åš | 0-15 |
| D | å¤šç©ºåŒæ—¶å­˜åœ¨ | è§‚æœ› | 0-15 |
| E | ä»…å°å‘¨æœŸä¿¡å· + å¤§å‘¨æœŸä¸­æ€§ | å¼±ä¿¡å·(éactionable) | 10-40 |
| F | å®Œå…¨ä¸­æ€§ | æ— ä¿¡å· | 0 |

---

## å››ã€Regime åˆ†ç±»ä¸åŠ¨æ€é˜ˆå€¼

### 4.1 äº”ç§å¸‚åœºçŠ¶æ€ (optimize_six_book.py:267-441)

åŸºäº 3 ä¸ªç»´åº¦å®æ—¶åˆ†ç±»ï¼ˆå‡ä½¿ç”¨ idx-1 çš„å·²å®Œæˆ bar æ•°æ®ï¼‰ï¼š

```python
vol = ret.rolling(48).std()                     # 48bar æ”¶ç›Šç‡æ ‡å‡†å·®
trend = (MA12 - MA48) / price                   # å‡çº¿ä»·å·®/ä»·æ ¼
atr_pct = ATR(14) / price                       # 14barçœŸå®æ³¢å¹…/ä»·æ ¼

# å›ºå®šé˜ˆå€¼
vol_high  = 0.020    # é«˜æ³¢åŠ¨
vol_low   = 0.007    # ä½æ³¢åŠ¨
trend_strong = 0.015 # å¼ºè¶‹åŠ¿
trend_weak   = 0.006 # å¼±è¶‹åŠ¿
atr_high  = 0.018    # ATRé«˜æ³¢åŠ¨
```

| Regime | æ¡ä»¶ | å…¥åœºé—¨æ§›è°ƒæ•´ | æ æ†/ä»“ä½ | å¹³ä»“è°ƒæ•´ |
|--------|------|-------------|----------|---------|
| `high_vol_choppy` | volâ‰¥0.020 ä¸” trendâ‰¤0.006 | ST/LT Ã— 1.22 | æ æ† Ã— 0.58 | å¹³ä»“ Ã— 0.90 |
| `high_vol` | volâ‰¥0.020 æˆ– ATRâ‰¥0.018 | ST/LT Ã— 1.12 | æ æ† Ã— 0.75 | å¹³ä»“ Ã— 0.95 |
| `low_vol_trend` | volâ‰¤0.007 ä¸” trendâ‰¥0.015 | ST/LT Ã— 0.95 | æ­£å¸¸ | å¹³ä»“ Ã— 1.05 |
| `trend` | trendâ‰¥0.015 | ST/LT Ã— 0.98 | æ­£å¸¸ | æ­£å¸¸ |
| `neutral` | ä»¥ä¸Šå‡ä¸æ»¡è¶³ | åŸºçº¿ä¸å˜ | æ­£å¸¸ | æ­£å¸¸ |

### 4.2 è¶‹åŠ¿æ–¹å‘å€¾æ–œ (optimize_six_book.py:404-409)

```python
if trend >= 0.006:     # ä¸Šå‡è¶‹åŠ¿
    long_threshold  *= 0.88  # åšå¤šæ›´å®¹æ˜“
    short_threshold *= 1.10  # åšç©ºæ›´éš¾
elif trend <= -0.006:  # ä¸‹é™è¶‹åŠ¿
    short_threshold *= 0.88  # åšç©ºæ›´å®¹æ˜“
    long_threshold  *= 1.10  # åšå¤šæ›´éš¾
```

### 4.3 P12: åŠ¨æ€ Regime é˜ˆå€¼ (å®éªŒæ€§, é»˜è®¤å…³é—­)

æ›¿ä»£å›ºå®šé˜ˆå€¼ï¼Œä½¿ç”¨æ»šåŠ¨ 90 å¤©ç™¾åˆ†ä½æ•°è‡ªé€‚åº”ï¼š

```python
# optimize_six_book.py:348-367, ABæµ‹è¯•ç»“è®º: OOSæ”¶ç›Š-1.23%, ä¸å¯ç”¨
if use_dynamic_regime_thresholds:
    vol_high  = rolling_vol.quantile(0.80, window=2160)
    vol_low   = rolling_vol.quantile(0.20, window=2160)
    trend_strong = rolling_trend.quantile(0.80, window=2160)
```

> **AB ç»“è®º** (D3): IS -14.51% vs åŸºçº¿ -12.58%, OOS +40.17% vs +41.40%ã€‚
> è½»å¾®è´Ÿå‘, ä¸å€¼å¾—å¼•å…¥å¤æ‚åº¦ã€‚

### 4.4 v9.0 Regime å¯¹ç­–ç•¥è¡Œä¸ºçš„å½±å“

| Regime | ç©ºå•å†³ç­– (v9.0) | P24 æ­¢æŸ | é—¨æ§›ä¹˜æ•° | æ æ†ä¹˜æ•° |
|--------|----------------|----------|---------|---------|
| **neutral** | **ç¦æ­¢å¼€ç©º (B1b neutral:999)** | N/A | 1.00 | 1.00 |
| trend | å…è®¸, Anti-Squeeze è¿‡æ»¤ | **-15%** | 0.98 | 1.00 |
| low_vol_trend | å…è®¸, +35 é—¨æ§› | -18% | 0.95 | 1.00 |
| high_vol | å…è®¸, Anti-Squeeze è¿‡æ»¤ | **-12%** | 1.12 | 0.75 |
| high_vol_choppy | å…è®¸, Anti-Squeeze è¿‡æ»¤ | -12% | 1.22 | 0.58 |

> **âš ï¸ v9.0.1 å‘ç°**: B1b åœ¨ IS ä¸­è¯¯æ€ç›ˆåˆ©ä¿¡å· (neutral short WR=68%, PnL=+$985)ã€‚P24 trend æ­¢æŸ -15% è¿‡åº¦æˆªæ–­åˆ©æ¶¦ ($9,121â†’$374)ã€‚è¯¦è§ç¬¬åä¸€ç« ã€‚

---

## äº”ã€å¾®ç»“æ„å åŠ ä¸åŒå¼•æ“

### 5.1 å¾®ç»“æ„ç‰¹å¾ (optimize_six_book.py:444-516)

åŸºäº K çº¿å†…å¯å¾—å­—æ®µæ„å»ºçš„ä»£ç†æŒ‡æ ‡ï¼ˆæ•°æ®ä¸è¶³æ—¶è‡ªåŠ¨å›é€€ï¼‰ï¼š

| æŒ‡æ ‡ | çœŸå®æ•°æ®æº | å›é€€ä»£ç† | è¯´æ˜ |
|------|-----------|---------|------|
| taker_imbalance | taker_buy_quote / quote_volume | å›ºå®š 0.5 | ä¸»åŠ¨ä¹°å–å¤±è¡¡ [-1, +1] |
| basis_z | (markPrice - indexPrice) / indexPrice | (close - VWAP) / VWAP | åŸºå·® z-score |
| oi_z | open_interest z-score | quote_volume z-score | æŒä»“é‡è¶‹åŠ¿ |
| funding_z | funding_rate z-score | basis Ã— 0.35 | èµ„é‡‘è´¹ç‡ä»£ç† |
| participation | quote_volume / median(48bar) | â€” | æˆäº¤é‡å‚ä¸åº¦ [0, 6] |

> **é‡è¦**: å½“å‰å›æµ‹ä¸­ï¼ŒOI/funding/basis å‡ä½¿ç”¨ OHLCV æ´¾ç”Ÿçš„ä»£ç†å€¼ã€‚
> binance_fetcher.py æœ‰è·å–çœŸå®åˆçº¦æ•°æ®çš„å‡½æ•° (`fetch_binance_funding_rates`,
> `fetch_binance_open_interest_hist`)ï¼Œä½†å°šæœªæ•´åˆåˆ°å›æµ‹ DataFrame ä¸­ã€‚

### 5.2 å¾®ç»“æ„å†³ç­–é€»è¾‘ (optimize_six_book.py:519-588)

```python
# ä¸»åŠ¨æˆäº¤å¤±è¡¡ï¼ˆå»¶ç»­é€»è¾‘ï¼‰
if taker_imbalance >= 0.08: long_score += 1.0
elif taker_imbalance <= -0.08: short_score += 1.0

# OIæ”¾å¤§ + æˆäº¤é‡å‚ä¸
if oi_z >= 0.8 and participation >= 1.15:
    # æ–¹å‘è·Ÿéš taker_imbalance

# åŸºå·®+èµ„é‡‘è´¹æç«¯ï¼ˆåè½¬ä¿¡å·ï¼‰
if basis_z >= 1.2 and funding >= 0.0006: short_score += 1.5  # å¤šå¤´æ‹¥æŒ¤
if basis_z <= -1.2 and funding <= -0.0006: long_score += 1.5  # ç©ºå¤´æ‹¥æŒ¤
```

**å¯¹ SS/BS çš„å½±å“** (optimize_six_book.py:591-646):
- å¾®ç»“æ„åå¤š: bs Ã— 1.08, ss Ã— 0.90, margin Ã— 1.10
- å¾®ç»“æ„åç©º: ss Ã— 1.08, bs Ã— 0.90, margin Ã— 1.10
- å¹…åº¦: diff = long_score - short_score, clipped to [-4, +4]

### 5.3 V9 Anti-Squeeze Filter (optimize_six_book.py:623-639)

ä¸“é—¨é’ˆå¯¹ trend/high_vol ç©ºå•è¢«æŒ¤å‹çš„é˜²æŠ¤ï¼š

```python
# å¤šå¤´æ‹¥æŒ¤æ£€æµ‹: fundingæé«˜ + OIå †ç§¯ + ä¸»åŠ¨ä¹°ç›˜å¼º
if (funding_rate >= 0.0008 and oi_z >= 1.0 and taker_imbalance >= 0.12):
    block_short = True      # ç¦æ­¢å¼€ç©º
    margin_mult *= 0.60     # å·²æœ‰ç©ºå•å‡ä»“60%

# ç©ºå¤´æ‹¥æŒ¤æ£€æµ‹ (é•œåƒ)
if (funding_rate <= -0.0008 and oi_z >= 1.0 and taker_imbalance <= -0.12):
    block_long = True
    margin_mult *= 0.60
```

> **v9.0 æ•°æ®å‡çº§**: `binance_fetcher.py` å·²å®ç°çœŸå®æ°¸ç»­åˆçº¦æ•°æ®è·å–:
> - `fetch_mark_price_klines()` (L266-382): Mark Price Kçº¿, ç”¨äºå¼ºå¹³æ£€æµ‹
> - `fetch_funding_rate_history()` (L385-494): Funding Rate å†å², æ”¯æŒåŠ¨æ€ç»“ç®—é¢‘ç‡
> - `fetch_open_interest_history()` (L497-601): OI å†å², ç”¨äºæ æ†å †ç§¯æ£€æµ‹
> - `merge_perp_data_into_klines()` (L604-642): åˆå¹¶åˆ°ä¸» DataFrame (ffill é¿å…å‰è§†)
>
> `live_signal_generator.py` (L202-230) å·²é›†æˆä¸Šè¿°æ•°æ®è·å–, å®ç›˜ä¿¡å·å¯ä½¿ç”¨çœŸå®è¡ç”Ÿå“æ•°æ®ã€‚
> **ä½†å›æµ‹å¼•æ“ä¸­ä»ä½¿ç”¨ä»£ç†å€¼** â€” éœ€è¦ P28 å°†çœŸå®æ•°æ®é›†æˆåˆ°å›æµ‹æµç¨‹ä¸­éªŒè¯ anti-squeeze æœ‰æ•ˆæ€§ã€‚

### 5.4 åŒå¼•æ“åˆ‡æ¢ (optimize_six_book.py:1881-1899)

æ ¹æ® regime + å¾®ç»“æ„çŠ¶æ€è‡ªåŠ¨é€‰æ‹©æ‰§è¡Œå¼•æ“ï¼š

| å¼•æ“æ¨¡å¼ | è§¦å‘æ¡ä»¶ | å…¥åœºé—¨æ§› | é€€å‡ºé—¨æ§› | æŒä»“ä¸Šé™ | æ æ† |
|---------|---------|---------|---------|---------|------|
| **trend** | trend/low_vol_trend regime | Ã—0.95 | Ã—1.05 | Ã—1.35 | Ã—1.10 |
| **reversion** | high_vol/high_vol_choppy | Ã—1.12 | Ã—0.90 | Ã—0.70 | Ã—0.75 |
| **single** | neutral æˆ–æœªå¯ç”¨ | Ã—1.0 | Ã—1.0 | Ã—1.0 | Ã—1.0 |

### 5.5 Vol-Targeting ä»“ä½ç¼©æ”¾ (optimize_six_book.py:626-656)

```python
target_vol_annual = 0.85                    # ç›®æ ‡å¹´åŒ–æ³¢åŠ¨ç‡
realized_vol = ret.rolling(48).std() * sqrt(bars_per_year)
scale = clip(target_vol / realized_vol, 0.45, 1.35)
margin_use *= scale
```

---

## å…­ã€é—¨æ§è¿‡æ»¤å±‚ï¼ˆå…¥åœºå‰å¤šå±‚è¿‡æ»¤ï¼‰

### 6.1 Regime åšç©ºé—¨æ§

**v9.0 B1b: neutral short ç›´æ¥ç¦æ­¢** (ç”Ÿäº§ v5):
```python
regime_short_threshold = 'neutral:999'
# â†’ neutral regime ä¸­ SS æ°¸è¿œè¾¾ä¸åˆ° 999, ç­‰æ•ˆäºå®Œå…¨ç¦æ­¢ neutral short
# v7.0 B3 åŸå€¼: 'neutral:60'
```

> **âš ï¸ v9.0.1 å›æµ‹å‘ç°**: IS ä¸­ neutral short 34ç¬” WR=68% PnL=+$985 (ç›ˆåˆ©ä¿¡å·)ã€‚
> B1b åŸºäº OOS 2024 æ•°æ® (neutral short PF=1.07, å¾®åˆ©) å’Œ DIV Cohen's d=-0.64 å†³ç­–,
> ä½† IS 2025 æ•°æ®ä¸æ”¯æŒ"neutral short æ—  alpha"å‡è®¾ã€‚è§ç¬¬åä¸€ç« ã€‚

**S1-b: low_vol_trend åšç©ºé—¨æ§**:
```python
if regime == 'low_vol_trend':
    short_threshold += 35   # éœ€è¦ SS â‰¥ 75 æ‰èƒ½å¼€ç©º
```

### 6.2 Neutral ç»“æ„è´¨é‡æ¸è¿›æŠ˜æ‰£ (æ ¸å¿ƒåˆ›æ–°, v7.0 B3)

æ£€æŸ¥ 5 æœ¬ç»“æ„ä¹¦ (CS/KDJ/MA/BB/VP) çš„ç‹¬ç«‹ç¡®è®¤æ•°é‡ï¼Œæ¸è¿›æŠ˜æ‰£ä»“ä½ï¼š

```python
# 5 æœ¬ç»“æ„ä¹¦çš„æ´»è·ƒåˆ¤å®š (activity_threshold = 10)
structural_keys = ['ma_sell', 'cs_sell', 'bb_sell', 'vp_sell', 'kdj_sell']
confirms = sum(1 for k in structural_keys if book_features[k] > 10.0)

# v7.0 B3 æŠ˜æ‰£è¡¨:
discount_map = {
    0: 0.00,   # ä»…divé©±åŠ¨ â†’ ç›´æ¥ç¦æ­¢ (v6: 0.10)
    1: 0.05,   # å¾®å¼±æ”¯æ’‘ â†’ 5%ä»“ä½ (v6: 0.20)
    2: 0.15,   # å°šå¯ â†’ 15%ä»“ä½ (v6: 1.00)
    3: 0.50,   # å¼ºå…±è¯† â†’ 50%ä»“ä½
    4: 1.00,   # æå¼º â†’ å…¨é¢
    5: 1.00,   # æ»¡ä¹¦ç¡®è®¤ â†’ å…¨é¢
}
margin *= discount_map[confirms]
```

**é›¶è´è¶æ•ˆåº”**: åªè°ƒèŠ‚ä»“ä½å¤§å°ï¼Œä¸æ”¹å˜å…¥åœºæ—¶åºã€‚

### 6.3 ç©ºå•å†²çªè½¯æŠ˜æ‰£

```python
# v9.0: ç”Ÿæ•ˆèŒƒå›´ç¼©å‡ä¸º trend, high_vol (neutral å·²è¢« B1b ç¦æ­¢, ä¸å¯è¾¾)
# v7.0 B3 åŸå€¼: 'trend,high_vol,neutral'
if regime in ('trend', 'high_vol'):
    if book_features['div_buy'] >= 50.0 and book_features['ma_sell'] >= 12.0:
        margin *= 0.60  # ç¼©ä»“ 0.60Ã—
```

### 6.4 P7: å¤§å‘¨æœŸæ–¹å‘é—¨æ§ (å®éªŒæ€§, é»˜è®¤å…³é—­)

```python
# optimize_six_book.py:2318-2323
# å½“ 4h+24h åŠ æƒæ–¹å‘çœ‹å¤šæ—¶, åœ¨ trend/high_vol ä¸­é˜»æ­¢å¼€ç©º
if use_trend_short_large_tf_gate and regime in ('trend', 'high_vol'):
    if large_bs > large_ss * 1.0:
        block_short = True
```

> **AB ç»“è®º** (C1): IS/OOS ä¸åŸºçº¿å®Œå…¨ç›¸åŒ, é—¨æ§ä»æœªè§¦å‘ã€‚
> åŸå› : å• TF å›æµ‹ä¸­ signal_meta æ—  large_bs/large_ss æ•°æ®ã€‚

### 6.5 P8: ç»“æ„ç¡®è®¤ç¡¬é—¨æ§› (å®éªŒæ€§, é»˜è®¤å…³é—­)

```python
# optimize_six_book.py:2327-2339
# trend/high_vol ä¸­ç©ºå•è¦æ±‚è‡³å°‘ 3 æœ¬ç»“æ„ä¹¦ç¡®è®¤
if use_trend_short_min_confirms and regime in ('trend', 'high_vol'):
    if confirms < 3:
        block_short = True
```

> **AB ç»“è®º** (C2): IS +0.14%, OOS +0.14%, å¾®å¼±æ­£å‘ä½†ä¸æ˜¾è‘—ã€‚

### 6.6 è¶‹åŠ¿ä¿æŠ¤ (ç°è´§åº•ä»“)

```python
# EMA10 > EMA30 Ã— 1.005 â†’ è¶‹åŠ¿æ¿€æ´»
if trend_up:
    # ETH ä»“ä½ â‰¤ 50% æ—¶å®Œå…¨ç¦æ­¢å–å‡º
    # è¶…å‡ºéƒ¨åˆ†æœ€å¤šå– 10%, å–å‡ºé˜ˆå€¼æé«˜åˆ° SSâ‰¥55
    # ç°è´§å†·å´æœŸæ‹‰é•¿åˆ° 48 bar
```

---

## ä¸ƒã€æ‰§è¡Œå¼•æ“å‚æ•° (v9.0.1)

### 7.1 ä¿¡å·é˜ˆå€¼

| å‚æ•° | å€¼ | å«ä¹‰ |
|------|-----|------|
| sell_threshold | 18 | ç°è´§å–å‡ºé—¨æ§› (SSâ‰¥18) |
| buy_threshold | 25 | ç°è´§ä¹°å…¥é—¨æ§› (BSâ‰¥25) |
| short_threshold | **40** | åˆçº¦åšç©ºé—¨æ§› (SSâ‰¥40, v9.0: neutralâ†’999 ç¦æ­¢) |
| long_threshold | **25** | åˆçº¦åšå¤šé—¨æ§› (BSâ‰¥25) |
| close_short_bs | 40 | åå‘å¹³ç©ºé—¨æ§› |
| close_long_ss | 40 | åå‘å¹³å¤šé—¨æ§› |

### 7.2 æ­¢æŸæ­¢ç›ˆ

| å‚æ•° | ç©ºå¤´ | å¤šå¤´ | è¯´æ˜ |
|------|------|------|------|
| SL (æ­¢æŸ) | **-20%** (è¢«P24è¦†ç›–) | **-10%** | PnL ç™¾åˆ†æ¯”æ­¢æŸ |
| TP (æ­¢ç›ˆ) | +60% | +40% | |
| PartialTP1 | **+15%** | +15% | å¹³ä»“ 30% ä»“ä½ |
| PartialTP2 | **+50%** | +50% | å¹³ä»“ 30% ä»“ä½ |
| hard_stop_loss | -28% | -28% | ç¡¬æ–­è·¯å™¨ |
| max_hold | 48 bar | 72 bar | æœ€å¤§æŒä»“Kçº¿æ•° |

**P24: Regime-Adaptive ç©ºå¤´æ­¢æŸ (v9.0, æ›¿ä»£å…¨å±€ -20%)**:

```python
# optimize_six_book.py:2189-2190, live_config.py:275-280
regime_short_sl_map = {
    'neutral':         -0.12,  # è¢« B1b ç¦æ­¢, ç†è®ºå€¼
    'trend':           -0.15,  # æ”¶ç´§: è¶‹åŠ¿ä¸­é”™è¯¯åº”å¿«é€Ÿæ­¢æŸ
    'low_vol_trend':   -0.18,  # ç•¥æ”¶ç´§
    'high_vol':        -0.12,  # æœ€ç´§: æŒ¤å‹é£é™©æœ€é«˜
    'high_vol_choppy': -0.12,
}
```

> **âš ï¸ v9.0.1 å›æµ‹å‘ç°**: P24 trend SL ä» -20%â†’-15% å¯¼è‡´ trend short PnL ä» +$9,121
> éª¤é™è‡³ +$374 (é™å¹… 96%), å°½ç®¡ WR ä» 64%â†’77%ã€‚å¤§è¶‹åŠ¿äº¤æ˜“æ— æ³•å……åˆ†å‘å±•ã€‚
> **P34 å»ºè®®**: å›é€€è‡³ -18% æˆ–æ”¹ç”¨ ATR-based åŠ¨æ€æ­¢æŸã€‚

**P20: ç©ºå¤´è¿½è¸ªæ”¶ç´§ (v8.1)**:
```python
# ç©ºå¤´ P13 è¿½è¸ªå®¹å¿åº¦: max_pb = 0.40 (vs å¤šå¤´ 0.60)
# â†’ ç©ºå¤´é”åˆ©æ›´ç§¯æ, é˜²æ­¢å¿«é€Ÿåè½¬åå™¬åˆ©æ¶¦
continuous_trail_max_pb_short = 0.40
```

### 7.3 P13 è¿ç»­è¿½è¸ªæ­¢ç›ˆ (v8.0 å¯ç”¨, æ›¿ä»£ç¦»æ•£é—¨æ§›)

```python
# optimize_six_book.py:2545-2554
# åˆ©æ¶¦ â‰¥ 5% æ—¶å¯åŠ¨è¿½è¸ª, å›æ’¤å®¹å¿éšåˆ©æ¶¦å¢é•¿ä» 60% æ”¶ç´§åˆ° 30%
if pnl_r >= continuous_trail_start_pnl:  # 0.05
    progress = min(pnl_r / actual_tp, 1.0)
    eff_pb = max_pb - (max_pb - min_pb) * progress
    # max_pb=0.60(ä½åˆ©æ¶¦å®½å®¹å¿), min_pb=0.30(é«˜åˆ©æ¶¦ç´§å®¹å¿)
    if pnl_r < short_max_pnl * eff_pb:
        close_position("è¿ç»­è¿½è¸ªæ­¢ç›ˆ")
```

> **AB éªŒè¯** (C6): IS PF 0.91â†’1.08 (+18.7%), OOS WR 61.0%â†’64.9% (+3.9pp), OOS PF 2.33â†’2.51ã€‚
> **Walk-Forward** (P15): 6 çª—å£ä¸­ 4 çª—å£ç›ˆåˆ©, å‡å€¼ Ret +9.74%/Qã€‚
> P13 æ˜¯å”¯ä¸€é€šè¿‡ IS+OOS+WF ä¸‰é‡éªŒè¯çš„æ”¹è¿›, å·²å¯ç”¨ã€‚

å½“ P13 å…³é—­æ—¶, å›é€€åˆ°æ—§ç‰ˆç¦»æ•£è¿½è¸ªæ­¢ç›ˆ:
```python
# åŸç‰ˆ: pnl >= short_trail(0.19) ä¸”ä»æœ€é«˜ç‚¹å›æ’¤ > 50% â†’ å¹³ä»“
# âš ï¸ cliff effect: 0.19 vs 0.20 å·® $15K (MFE å¯†é›†å †ç§¯åœ¨ 19%~20%)
```

### 7.4 ä»“ä½ç®¡ç†

```python
leverage = 5                    # åŸºç¡€æ æ†
max_leverage = 5                # ä¸Šé™
margin_use = 0.70               # å¯ç”¨ä¿è¯é‡‘ä½¿ç”¨æ¯”ä¾‹

# åŠ¨æ€æ æ†(æŒ‰ä¿¡å·å¼ºåº¦, optimize_six_book.py:2442)
if SS >= 50:  actual_lev = min(5, max_lev)
elif SS >= 35: actual_lev = min(3, max_lev)
else:          actual_lev = 2

# Vol-Targeting: margin_use *= clip(0.85 / realized_vol, 0.45, 1.35)
# Regime: high_vol_choppy â†’ risk_mult=0.58, high_vol â†’ risk_mult=0.75
```

### 7.5 å†·å´æœºåˆ¶

| äº‹ä»¶ | å†·å´ |
|------|------|
| æ­£å¸¸å¼€ä»“å | **cooldown = 6 bar** (v7.0 B3: 4â†’6) |
| ç°è´§æ“ä½œå | spot_cooldown = 12 bar |
| æ­¢æŸå | cooldown Ã— 4 (ç©º/å¤šå„è‡ª) |
| è¿ç»­æ­¢æŸ (â‰¥2æ¬¡) | cooldown Ã— 4 Ã— 2 (åŠ å€) |
| æ­¢æŸ(è·¨æ–¹å‘) | cooldown Ã— 3 |
| å¼ºå¹³å | cooldown Ã— 6 |
| å¼ºå¹³å(è·¨æ–¹å‘) | cooldown Ã— 3 |
| åæ‰‹æœ€å°‘æŒä»“ | 8 bar (å¤š/ç©ºå‡æ˜¯) |

### 7.6 è´¹ç”¨æ¨¡å‹

```python
# strategy_futures.py:95-99
TAKER_FEE    = 0.0005   # 0.05% (å¼€/å¹³ä»“å‡æ”¶)
MAKER_FEE    = 0.0002   # 0.02% (æœªä½¿ç”¨, ç­–ç•¥å‡ taker)
SLIPPAGE     = 0.001    # 0.1%  (åµŒå…¥æ‰§è¡Œä»·)
FUNDING_RATE = 0.0001   # Â±0.01% / 8h (åŸºå‡†)
LIQUIDATION_FEE = 0.005 # 0.5%
MAINTENANCE_RATE = 0.05 # 5% ç»´æŒä¿è¯é‡‘ç‡

# Funding æ¨¡å‹: æ¯ bars_per_8h æ ¹ bar ç»“ç®—ä¸€æ¬¡
# åŠ¨æ€æ–¹å‘: 70% æ­£è´¹ç‡ (å¤šå¤´ä»˜ç©ºå¤´), 30% è´Ÿè´¹ç‡ (ç©ºå¤´ä»˜å¤šå¤´)
```

### 7.7 é£é™©æ§åˆ¶ (strategy_futures.py:101-138)

```python
max_margin_total = initial_total * 0.10    # æ€»ä¿è¯é‡‘ä¸Šé™
max_single_margin = initial_total * 0.05   # å•ä»“ä¿è¯é‡‘ä¸Šé™
max_lifetime_margin = initial_total * 1.50 # æœˆåº¦ç´¯è®¡ä¿è¯é‡‘ä¸Šé™

# å¼ºå¹³é€»è¾‘: remaining_margin < notional Ã— maintenance_rate(5%)
# å¼ºå¹³æ£€æµ‹: ç©ºä»“ç”¨ bar_high, å¤šä»“ç”¨ bar_low (intrabar ç©¿è¶Š)
```

---

## å…«ã€ä¿¡å·æ—¶åºä¸æ‰§è¡Œæµç¨‹

### 8.1 å»¶è¿Ÿæ‰§è¡Œ (æ¶ˆé™¤ same-bar bias)

```
bar[i-1] close:  è®¡ç®— score_provider(idx=i-1) â†’ pending_ss, pending_bs
bar[i]   open:   ä½¿ç”¨ pending_ss/pending_bs åšå†³ç­–
                 exec_price = open_prices[idx=i]  # ç”¨å½“å‰ bar çš„å¼€ç›˜ä»·æ‰§è¡Œ
bar[i]   close:  è®¡ç®— score_provider(idx=i) â†’ å­˜ä¸ºä¸‹ä¸€æ ¹ bar çš„ pending
```

### 8.2 æ¯æ ¹ bar çš„å¤„ç†é¡ºåº

```
1. è¯»å– exec_price = open[idx]
2. æœˆåº¦ä¿è¯é‡‘é¢åº¦é‡ç½®
3. å¼ºå¹³æ£€æµ‹ (ç”¨ bar å†… high/low æå€¼)
4. èµ„é‡‘è´¹ç‡è®¡ç®— (æ¯ bars_per_8h æ ¹ bar)
5. å†·å´å€’è®¡æ—¶ (short_cd, long_cd, spot_cd å„è‡ªé€’å‡)
6. é£æ§æ£€æŸ¥ (æ—¥å†…äºæŸé¢„ç®—ã€å…¨å±€å›æ’¤åœæœº)
7. Regime æ£€æµ‹ + åŒå¼•æ“åˆ‡æ¢ + å¾®ç»“æ„å åŠ  + P9è°ƒæƒ(å¦‚å¯ç”¨)
8. ä½¿ç”¨ pending ä¿¡å·åšå†³ç­–:
   a. å–å‡ºç°è´§ (å¸¦ç¡®è®¤è¿‡æ»¤ + regime é—¨æ§)
   b. åå‘å¹³ä»“ (å…ˆå¹³å†å¼€, éœ€æŒä»“â‰¥8bar)
   c. å¼€ç©º (å¤šå±‚é—¨æ§: regime â†’ ç»“æ„æŠ˜æ‰£ â†’ å†²çªæŠ˜æ‰£ â†’ P7/P8 â†’ å¾®ç»“æ„)
   d. P6 ghost cooldown (è¢«è¿‡æ»¤çš„å¼ºä¿¡å·ä¹Ÿè§¦å‘å†·å´)
   e. P10 fast-fail (å‰3baräº>5%ç«‹å³å¹³ä»“, å¦‚å¯ç”¨)
   f. æŒä»“ç®¡ç†: SL â†’ P13è¿ç»­è¿½è¸ª â†’ PartialTP â†’ TP â†’ æ—¶é—´æ­¢æŸ
   g. å¼€å¤š (é—¨æ§è¿‡æ»¤, ä¸ç©ºå•é•œåƒ)
   h. å¤šä»“ç®¡ç† (ä¸ç©ºä»“é•œåƒ)
   i. ä¹°å…¥ç°è´§
9. æ¯4æ ¹barè®°å½•å†å²å¿«ç…§
10. è®¡ç®—å½“å‰ bar ä¿¡å· â†’ å­˜ä¸º pending (ä¾›ä¸‹æ ¹ bar ä½¿ç”¨)
```

---

## ä¹ã€å›æµ‹éªŒè¯ç»“æœ

### 9.1 ç‰ˆæœ¬æ¼”è¿›å¯¹æ¯”

**In-Sample (IS): 2025-01 ~ 2026-01**:

| ç‰ˆæœ¬ | Return | WR | PF | MDD | Trades |
|------|--------|-----|------|------|--------|
| v6.0 baseline | -14.22% | 58.4% | 1.026 | -17.79% | 89 |
| v7.0 B3 | -13.32% | 57.7% | 0.907 | -15.61% | 71 |
| **v8.0 B3+P13** | **-12.58%** | **53.8%** | **1.079** | **-15.62%** | **91** |

**Out-of-Sample (OOS): 2024-01 ~ 2024-12**:

| ç‰ˆæœ¬ | Return | WR | PF | MDD | Trades |
|------|--------|-----|------|------|--------|
| v6.0 baseline | +35.95% | 60.7% | 1.666 | -16.84% | 84 |
| v7.0 B3 | +41.58% | 61.0% | 2.326 | -14.41% | 77 |
| **v8.0 B3+P13** | **+41.40%** | **64.9%** | **2.510** | **-14.29%** | **77** |

> IS æœŸé—´ (2025) å¸‚åœº regime ä»¥ neutral å’Œ trend äº¤æ›¿ä¸ºä¸», ETH ä»·æ ¼åŒºé—´éœ‡è¡ã€‚
> OOS æœŸé—´ (2024) åŒ…å«å¤šæ¬¡è¶‹åŠ¿æ€§è¡Œæƒ…, ç­–ç•¥çš„ neutral_long è·åˆ©ä¸°åšã€‚

### 9.2 OOS RegimeÃ—Direction æ‹†è§£ (v8.0)

| SideÃ—Regime | äº¤æ˜“æ•° | WR | PnL |
|-------------|--------|-----|------|
| long\|neutral | 9 | **100%** | +$2,010 |
| long\|low_vol_trend | 3 | 67% | +$1,062 |
| long\|trend | 3 | 67% | +$171 |
| short\|neutral | 13 | 62% | +$536 |
| short\|trend | 8 | **88%** | +$1,339 |
| short\|high_vol | 4 | 100% | +$943 |

> **æ ¸å¿ƒå‘åŠ¨æœº**: neutralÃ—long (WR=100%, $2,010 åˆ©æ¶¦) è´¡çŒ®äº† OOS çš„ä¸»è¦ alphaã€‚

### 9.3 v9.0 å®Œæ•´å›æµ‹: v5 ç”Ÿäº§é…ç½®éªŒè¯ (2026-02-15)

**âš ï¸ å…³é”®æ–°å¢**: éªŒè¯ v5 ç²¾ç¡®ç”Ÿäº§é…ç½® (B1b + P24 + P13 + P20) çš„ IS/OOS è¡¨ç°ã€‚

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_full_backtest_20260215_184527.csv`

| å˜ä½“ | IS Ret | IS WR | IS PF | IS MDD | IS Trades | OOS Ret | OOS WR | OOS PF | OOS MDD | OOS Trades |
|------|--------|-------|-------|--------|-----------|---------|--------|--------|---------|------------|
| **E0** v8åŸºçº¿ | **+67.3%** | 56.9% | **1.181** | -11.9% | 153 | -3.8% | 65.1% | 1.589 | -26.7% | 43 |
| **E1** v5ç”Ÿäº§ | +46.6% | 56.4% | **0.898** âš ï¸ | -14.9% | 110 | -3.8% | 65.1% | 1.589 | -26.7% | 43 |
| E2 v5+P18lite | -14.5% | 53.8% | 0.443 | -19.6% | 26 | **+41.1%** | 68.4% | **2.271** | -16.9% | 76 |
| E3 v5+P18+P23 | +5.0% | 59.2% | 0.707 | -17.0% | 76 | +37.8% | 69.3% | 2.132 | -16.5% | 75 |

**v5 Regime Ã— Direction IS æ˜ç»†** (å®é™… CSV æ•°æ®):

| å˜ä½“ | short\|neutral | short\|trend | long\|neutral | long\|trend |
|------|----------------|--------------|---------------|-------------|
| E0 | n=34 WR=68% +$985 | n=14 WR=64% **+$9,121** | n=27 WR=48% -$374 | n=6 WR=83% +$6,855 |
| E1 | **ç¦æ­¢ (B1b)** | n=13 WR=77% **+$374** | n=28 WR=57% +$3,589 | n=6 WR=100% +$4,423 |
| E0/E1 OOS | â€” | â€” | n=29 WR=66% +$6,280 | n=6 WR=83% +$3,179 |

**âš ï¸ ä¸‰å¤§å‘ç°**:

1. **E1 IS PF=0.898 è·Œç ´ 1.0**: v5 é…ç½® IS ç›ˆäºæ¯”è§’åº¦å‡€äºæŸã€‚Return +46.6% ç”±å°‘æ•°å¤§èµ¢å•æ”¯æ’‘, éç³»ç»Ÿæ€§ç›ˆåˆ©ã€‚
2. **B1b è¯¯æ€ç›ˆåˆ©ä¿¡å·**: E0 neutral short 34ç¬” WR=68% PnL=+$985 (ç›ˆåˆ©), è¢« B1b å…¨éƒ¨ç¦æ­¢ã€‚IS æ•°æ®ä¸æ”¯æŒ"neutral short æ—  alpha"å‡è®¾ã€‚
3. **P24 æ­¢æŸæˆªæ–­åˆ©æ¶¦**: E0 trend short PnL=+$9,121 â†’ E1 ä»… +$374 (é™å¹… 96%)ã€‚WR ä» 64%â†’77%, ä½† -15% SL å¤šæˆªæ–­äº† 5% å›æ’¤ç©ºé—´, å¤§è¶‹åŠ¿äº¤æ˜“æ— æ³•å……åˆ†å‘å±•ã€‚
4. **OOS æ— å·®å¼‚**: 2024 å¹´ OOS æ—  short äº¤æ˜“, E0/E1 å®Œå…¨ç›¸åŒ â†’ v9 æ–°ç‰¹æ€§é›¶éªŒè¯ã€‚

### 9.4 v9.0 AB å®éªŒ: å•ç‰¹æ€§éš”ç¦»æµ‹è¯•

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_ab_20260215_164522.csv`

| å˜ä½“ | ç‰¹æ€§ | IS Ret | IS PF | IS Trades | OOS Ret | OOS PF | OOS Trades |
|------|------|--------|-------|-----------|---------|--------|------------|
| D0 | v8 åŸºçº¿ | +48.2% | 0.916 | 159 | -3.6% | 1.679 | 43 |
| D1 | P18 regimeèåˆ | -10.7% | 1.438 | 39 | **+12.8%** | 1.263 | 70 |
| D2 | P24 regime SL | +43.8% | 0.859 | 160 | -3.6% | 1.679 | 43 |
| D3 | P20 ç©ºå¤´æ”¶ç´§ | **+53.8%** | 0.955 | 150 | -3.6% | 1.679 | 43 |
| D4 | B1b neutralç¦æ­¢ | +44.5% | 0.842 | 92 | -3.6% | 1.679 | 43 |
| D7 | B1b+P20 | +43.0% | 0.822 | 90 | -3.6% | 1.679 | 43 |
| D8 | P18+P24+P20+B1b | -6.9% | 0.946 | 22 | +12.4% | 1.184 | 60 |

> D1 P18 æ˜¯å”¯ä¸€æ”¹å–„ OOS çš„å•ç‰¹æ€§ (+12.8% vs -3.6%), ä½† IS å¤§å¹…è¡°é€€ (-10.7%)ã€‚
> D2-D4 çš„ OOS ä¸åŸºçº¿ç›¸åŒ (2024 æ—  short äº¤æ˜“)ã€‚

### 9.5 v9.0 Round 3: P18/P21/P23 ç»„åˆå®éªŒ

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_ab_r3_20260215_180525.csv`

| å˜ä½“ | ç‰¹æ€§ | IS Ret | IS PF | OOS Ret | OOS PF | OOS Trades | Worst-5 |
|------|------|--------|-------|---------|--------|------------|---------|
| E0 | åŸºçº¿(bugfix) | +65.7% | 1.140 | -3.3% | 1.672 | 43 | -$15,069 |
| E1 | P23 åŠ æƒç¡®è®¤ | +43.2% | 0.954 | -12.6% | 0.725 | 42 | -$15,649 |
| E2 | P21 risk-R | -10.0% | 0.238 | +0.1% | 1.611 | 43 | -$10,028 |
| **E4** | **P18lite+P23** | -6.2% | 0.943 | **+28.9%** | **1.327** | **107** | -$13,215 |
| **E5** | **full v9** | -4.2% | **1.179** | +12.7% | 1.087 | 110 | **-$7,021** |

> **E4 å…³é”®å‘ç°**: P18-lite + P23 ç»„åˆ OOS ä» -3.3% é£™å‡è‡³ +28.9%, äº¤æ˜“æ•°ä» 43â†’107 (æ¿€æ´»äº† short)ã€‚
> **E5 full v9**: Worst-5 ä» -$15,069 é™è‡³ -$7,021, å°¾éƒ¨é£é™©å¤§å¹…æ”¹å–„ã€‚
> **ä½† IS åˆ†è£‚**: E4/E5 IS å‡ä¸ºäºæŸæˆ–æŒå¹³, IS/OOS åˆ†è£‚ä¸¥é‡, ä¸æ•¢ç›´æ¥å¯ç”¨ã€‚

### 9.6 Walk-Forward éªŒè¯ (P15, 6ä¸ªæœˆè®­ç»ƒ / 3ä¸ªæœˆæµ‹è¯•)

| çª—å£ | è®­ç»ƒæœŸ | æµ‹è¯•æœŸ | Train Ret | Test Ret | Test WR | Test PF | Test MDD |
|------|--------|--------|----------|---------|---------|---------|----------|
| W1 | 2024-01~06 | 2024-07~09 | +45.1% | -3.14% | 58.8% | 2.294 | -12.22% |
| W2 | 2024-04~09 | 2024-10~12 | -13.89% | **+27.72%** | 62.0% | 1.913 | -6.51% |
| W3 | 2024-07~12 | 2025-01~03 | -8.17% | -11.96% | 69.8% | 1.134 | -14.98% |
| W4 | 2024-10~03 | 2025-04~06 | +18.15% | **+39.02%** | 59.0% | 1.469 | -11.10% |
| W5 | 2025-01~06 | 2025-07~09 | -11.29% | **+15.37%** | 54.3% | 0.394 | -7.29% |
| W6 | 2025-04~09 | 2025-10~12 | +12.69% | -9.55% | 60.0% | 3.420 | -14.09% |

| ç»Ÿè®¡ | å€¼ |
|------|------|
| ç›ˆåˆ©çª—å£ | **4/6 (66.7%)** |
| å¹³å‡æµ‹è¯•æ”¶ç›Š | **+9.58%/Q** |
| å¹³å‡æµ‹è¯• WR | **60.7%** |
| å¹³å‡æµ‹è¯• PF | **1.77** |
| æœ€å·®çª—å£ | W3 (-11.96%, 2025 Q1 neutral éœ‡è¡) |
| æœ€ä½³çª—å£ | W4 (+39.02%, 2025 Q2 è¶‹åŠ¿è¡Œæƒ…) |

> ç­–ç•¥å¯¹ regime æœ‰ä¸­ç­‰ä¾èµ–æ€§: è¶‹åŠ¿è¡Œæƒ…ä¸­è¡¨ç°ä¼˜å¼‚, æ¨ªç›˜éœ‡è¡ä¸­äºæŸã€‚

### 9.4 å‚æ•°æ•æ„Ÿåº¦ (P1 Monte Carlo)

**50 æ¬¡éšæœºæ‰°åŠ¨ Â±10%**, 13 ä¸ªæ ¸å¿ƒå‚æ•° (ST, LT, SL, Trail, TP, weights, discounts):

| ç»Ÿè®¡é‡ | IS Return | OOS Return |
|--------|----------|-----------|
| p5 (æœ€å·® 5%) | -14.8% | +34.5% |
| p50 (ä¸­ä½æ•°) | -14.2% | +35.9% |
| p95 (æœ€å¥½ 5%) | -13.4% | +36.4% |

> **ç»“è®º**: OOS æ”¶ç›Šåœ¨ Â±10% æ‰°åŠ¨ä¸‹ä¿æŒåœ¨ +34.5%~+36.4% åŒºé—´, é²æ£’æ€§è‰¯å¥½ã€‚
> æ•æ„Ÿåº¦æ’åº: short_threshold > long_threshold > div_weight > trail_pullbackã€‚

### 9.5 é€€å‡ºæœºåˆ¶æ¶ˆè (P3)

| æ¶ˆèé¡¹ | IS Ret | Î”Ret | IS PF | å½±å“è¯„ä¼° |
|--------|--------|------|-------|---------|
| baseline | -14.22% | â€” | 1.026 | â€” |
| ç§»é™¤åå‘å¹³ä»“ | -16.08% | **-1.86%** | 0.745 | æœ€å…³é”®é€€å‡º |
| ç§»é™¤æ—¶é—´æ­¢æŸ | -16.23% | **-2.01%** | 0.740 | ç¬¬äºŒå…³é”® |
| ç§»é™¤è¿½è¸ªæ­¢ç›ˆ | -13.32% | +0.90% | 1.086 | ç§»é™¤åè€Œæ”¹å–„(P13è§£å†³) |
| ç§»é™¤åˆ†æ®µæ­¢ç›ˆ | -14.65% | -0.43% | 1.355 | å¾®å¼±å½±å“ |
| ç§»é™¤ç¡¬æ­¢æŸ | -14.22% | 0.00% | 1.026 | æœªè§¦å‘ |
| ç§»é™¤å…¨éƒ¨æ­¢æŸ | -13.36% | -0.14% | 1.119 | æ­¢æŸè´¡çŒ®æå° |

> **æ ¸å¿ƒå‘ç°**: åå‘å¹³ä»“å’Œæ—¶é—´æ­¢æŸæ˜¯æœ€é‡è¦çš„é€€å‡ºæœºåˆ¶, è¿½è¸ªæ­¢ç›ˆç¦»æ•£ç‰ˆåè€Œæœ‰å®³(å·²è¢« P13 æ›¿ä»£)ã€‚

### 9.6 short_trail å‚æ•°æ•æ„Ÿåº¦ (P2)

17 ä¸ªæµ‹è¯•ç‚¹ (0.160 ~ 0.240, step=0.005):
- æœ€ä¼˜åŒºé—´: **0.190 ~ 0.240** (IS Return ç¨³å®šåœ¨ -13.3%)
- 0.190 â†’ 0.225 åŒºé—´ä¸ºå¹³å°, å˜åŒ– <1%
- P13 è¿ç»­è¿½è¸ªæ­¢ç›ˆå½»åº•æ¶ˆé™¤äº†æ­¤å¤„çš„ cliff effect

---

## åã€P6-P24 å®éªŒç‰¹æ€§éªŒè¯

### 10.1 ç¬¬ä¸€æ‰¹ A/B: P6-P10 + P13 (åŸºçº¿: v7.0 B3)

| å˜ä½“ | ç‰¹æ€§ | IS Ret | Î”IS | IS PF | OOS Ret | Î”OOS | OOS WR | ç»“è®º |
|------|------|--------|-----|-------|---------|------|--------|------|
| C0 | åŸºçº¿ | -13.32% | â€” | 0.91 | +41.58% | â€” | 61.0% | â€” |
| C1 | P7 24hæ–¹å‘é—¨æ§ | -13.32% | 0.00% | 0.91 | +41.58% | 0.00% | 61.0% | **æ— æ•ˆ**(æœªè§¦å‘) |
| C2 | P8 confirmsâ‰¥3 | -13.18% | +0.14% | 0.87 | +41.72% | +0.14% | 61.8% | å¾®æ­£å‘ |
| C3 | P7+P8 | -13.18% | +0.14% | 0.87 | +41.72% | +0.14% | 61.8% | P7æ— è´¡çŒ® |
| C4 | P6 ghost cooldown | -13.32% | 0.00% | 0.91 | +41.58% | 0.00% | 61.0% | **æ— æ•ˆ**(æœªè§¦å‘) |
| C5 | P10 fast-fail | -13.58% | -0.26% | 0.86 | +41.58% | 0.00% | 61.0% | **è´Ÿå‘** |
| **C6** | **P13 è¿ç»­è¿½è¸ª** | **-12.58%** | **+0.74%** | **1.08** | **+41.40%** | **-0.18%** | **64.9%** | **ISæ­£å‘+OOS WRå¤§å¢** |
| C7 | P7+P8+P6+P10 | -13.66% | -0.34% | 0.83 | +41.72% | +0.14% | 61.8% | ç»„åˆè´Ÿå‘ |
| C8 | å…¨éƒ¨å¼€å¯ | -14.93% | -1.61% | 1.15 | +41.23% | -0.35% | 64.5% | æ··åˆ |

### 10.2 ç¬¬äºŒæ‰¹ A/B: P9 + P12 (åŸºçº¿: v7.0 B3 + P13)

| å˜ä½“ | ç‰¹æ€§ | IS Ret | IS PF | OOS Ret | Î”OOS | ç»“è®º |
|------|------|--------|-------|---------|------|------|
| D0 | åŸºçº¿(B3+P13) | -12.58% | 1.08 | +41.40% | â€” | â€” |
| D1 | P9 æ¸©å’Œ(SSÃ—0.85,BSÃ—1.10) | -13.91% | 1.54 | +35.53% | **-5.87%** | **OOSå¤§å¹…é€€åŒ–** |
| D2 | P9 æ¿€è¿›(SSÃ—0.75,BSÃ—1.20) | -15.81% | 1.59 | +37.67% | -3.73% | é€€åŒ– |
| D3 | P12 åŠ¨æ€regimeé˜ˆå€¼ | -14.51% | 1.08 | +40.17% | -1.23% | è½»å¾®è´Ÿå‘ |
| D4 | P9+P12 | -13.86% | 1.28 | +36.20% | -5.20% | é€€åŒ– |
| D5 | P14 å¤šå¤´æŠ˜æ‰£(å¯¹ç§°åŒ–) | -12.58% | 1.08 | +41.40% | 0.00% | æ— æ•ˆæœ |
| D7 | å¯¹ç…§(æ— P13) | -13.32% | 0.91 | +41.58% | +0.18% | ç¡®è®¤P13è´¡çŒ® |

### 10.3 å®éªŒç»“è®ºæ±‡æ€»

| ç¼–å· | ç‰¹æ€§ | é…ç½®å¼€å…³ | ç”Ÿäº§çŠ¶æ€ | ABç»“è®º |
|------|------|---------|---------|--------|
| P6 | Ghost cooldown | `use_ghost_cooldown` | **å…³é—­** | æ— æ•ˆ(æœªè§¦å‘) |
| P7 | 24hæ–¹å‘é—¨æ§ | `use_trend_short_large_tf_gate` | **å…³é—­** | æ— æ•ˆ(æœªè§¦å‘) |
| P8 | ç»“æ„ç¡®è®¤ç¡¬é—¨æ§› | `use_trend_short_min_confirms` | **å…³é—­** | å¾®æ­£å‘(ä¸æ˜¾è‘—) |
| P9 | Regime-adaptive SS/BSè°ƒæƒ | `use_regime_adaptive_reweight` | **å…³é—­** | OOSé€€åŒ–-5.87% |
| P10 | Fast-failé€€å‡º | `use_fast_fail_exit` | **å…³é—­** | ISè´Ÿå‘ |
| P12 | åŠ¨æ€regimeé˜ˆå€¼ | `use_dynamic_regime_thresholds` | **å…³é—­** | OOSé€€åŒ–-1.23% |
| **P13** | **è¿ç»­è¿½è¸ªæ­¢ç›ˆ** | `use_continuous_trail` | **v4å¯ç”¨** | IS PF+18.7%, OOS WR+3.9pp |
| **P18** | **Regime-adaptiveèåˆæƒé‡** | `use_regime_adaptive_fusion` | **v5å…³é—­** | OOS+12.8% ä½†IS-10.7% (å•ç‹¬); ä¸P23ç»„åˆ OOS+28.9% |
| **P20** | **ç©ºå¤´è¿½è¸ªæ”¶ç´§** | `continuous_trail_max_pb_short` | **v5å¯ç”¨** | IS+5.6%, OOSæ— å½±å“(æ— short) |
| **P21** | **R-basedä»“ä½ç®¡ç†** | `use_risk_per_trade` | **å…³é—­** | IS-10%, 1.5% R%è¿‡ä¿å®ˆ |
| **P23** | **åŠ æƒç»“æ„ç¡®è®¤** | `use_weighted_confirms` | **å…³é—­** | ç‹¬ç«‹ OOS-12.6%, ä¸P18ç»„åˆ OOS+28.9% |
| **P24** | **Regime-adaptiveæ­¢æŸ** | `use_regime_adaptive_sl` | **v5å¯ç”¨** | âš ï¸ trend profit -96% ($9,121â†’$374) |
| **B1b** | **neutral shortç¦æ­¢** | `regime_short_threshold=neutral:999` | **v5å¯ç”¨** | âš ï¸ IS è¯¯æ€ç›ˆåˆ©ä¿¡å· (WR=68%, +$985) |

### 10.4 v9.0 æ¶æ„ç®€åŒ–å“²å­¦

```
v7.0/v8.0 ("ä¿®è¡¥æ´¾"):
  neutral short æœ‰é—®é¢˜ â†’ åŠ é—¨æ§›60 â†’ åŠ ç»“æ„æŠ˜æ‰£ â†’ åŠ å†²çªæŠ˜æ‰£
  â†’ åŠ å†·å´å»¶é•¿ â†’ åŠ å…±è¯†é—¨æ§ â†’ åŠ æç«¯èƒŒç¦»å¦å†³ â†’ ...
  é—®é¢˜: å¤æ‚åº¦æŒ‡æ•°å¢é•¿, ä½†å¤©èŠ±æ¿ä¸é«˜

v9.0 ("å‡æ³•æ´¾"):
  neutral short æœ‰é—®é¢˜ â†’ ç›´æ¥ç¦æ­¢ (B1b neutral:999)
  å‰©ä½™ short â†’ å·®å¼‚åŒ–æ­¢æŸ (P24) + åæŒ¤å‹è¿‡æ»¤ (Anti-Squeeze)
  é—®é¢˜: ç®€å•, å¯è§£é‡Š, å¯ç»´æŠ¤
  âš ï¸ ä½† v9.0.1 å›æµ‹æ˜¾ç¤º IS PF<1.0, å‡æ³•å¯èƒ½è¿‡äºæ¿€è¿›
```

### 10.5 P16 å…­ä¹¦ä¿¡å·åˆ¤åˆ«åŠ› (Cohen's d)

| ä¹¦ | neutral short d | å…¨ regime d (ç©º) | åˆ¤åˆ«ç­‰çº§ |
|----|----------------|-----------------|---------|
| DIV | **-0.64** (åå‘) | è´Ÿå‘ | âŒ åå‘æŒ‡æ ‡ |
| CS | +0.11 | **+0.215** | âœ… æœ€å¼º (å…¨regime) |
| MA | -0.02 | **+0.215** | âœ… æœ€å¼º (å…¨regime) |
| KDJ | +0.08 | +0.135 | âš ï¸ ä¸­ç­‰ |
| VP | +0.03 | +0.178 | âš ï¸ ä¸­ç­‰ |
| BB | +0.05 | è´Ÿå‘ | âŒ æ—  alpha |

> **v9.0 å†³ç­–ä¾æ®**: DIV d=-0.64 (neutral short ä¸­èµ¢å• DIV åˆ†æ•°åè€Œæ›´ä½)ã€‚
> å››å¤§ LLM å…±è¯†: ä¸å…¶ä¿®è¡¥ neutral short, ä¸å¦‚ç›´æ¥ç¦æ­¢ (B1b)ã€‚
> ä½† IS 2025 æ•°æ®ä¸­ neutral short æ•´ä½“ç›ˆåˆ©, è¯´æ˜åˆ¤åˆ«åŠ› â‰  ç›ˆåˆ©èƒ½åŠ›ã€‚

---

## åä¸€ã€å·²çŸ¥é—®é¢˜ä¸æ•°æ®é©±åŠ¨åˆ†æ

### 11.0 ğŸ”´ ç´§æ€¥: v5 ç”Ÿäº§é…ç½® IS PF < 1.0 (2026-02-15 å‘ç°)

**é—®é¢˜**: v5 ç”Ÿäº§é…ç½® (B1b + P24 + P13 + P20) åœ¨ IS æœŸé—´ PF=0.898, è·Œç ´ 1.0 åŸºå‡†çº¿ã€‚Return +46.6% ç”±å°‘æ•°å¤§èµ¢å•æ”¯æ’‘, å¹¶éç³»ç»Ÿæ€§ç›ˆåˆ©ã€‚

**æ ¹å› åˆ†è§£**:

| å› ç´  | E0 (v8åŸºçº¿) | E1 (v5) | å·®å€¼ | å æ¯” |
|------|------------|---------|------|------|
| B1b è¯¯æ€ neutral short | n=34 +$985 | ç¦æ­¢ | **-$985** | ~4.8% |
| P24 trend SL æˆªæ–­ | n=14 +$9,121 | n=13 +$374 | **-$8,747** | ~42% |
| B1b é‡Šæ”¾ long å®¹é‡ | n=27 -$374 | n=28 +$3,589 | **+$3,963** | +19% |
| æ€» IS Return å·®å¼‚ | +67.3% | +46.6% | **-20.7%** | |
| æ€» IS PF å·®å¼‚ | 1.181 | 0.898 | **-0.283** | |

> **å…³é”®åˆ¤æ–­**: P24 æ˜¯ IS PF<1.0 çš„ä¸»è¦è´¡çŒ®è€… (42%), B1b æ˜¯æ¬¡è¦è´¡çŒ®è€… (4.8%)ã€‚
> P24 çš„ trend -15% SL åœ¨è¶‹åŠ¿è¡Œæƒ…ä¸­è¿‡åº¦æˆªæ–­äº†åˆ©æ¶¦ã€‚

**ç´§æ€¥æªæ–½**: è§ç¬¬åäºŒç«  P33/P34/P35ã€‚

### 11.1 DIV æƒé‡-æœ‰æ•ˆæ€§é”™é…

**æ•°æ®**: neutral regime å å…¨éƒ¨äº¤æ˜“ 64%, DIV åœ¨ neutral ä¸­ Cohen's d = -0.04 (å‡ ä¹æ— åˆ¤åˆ«åŠ›, ç”šè‡³å¾®è´Ÿ)ã€‚CS(d=0.40), KDJ(d=0.42), MA(d=0.38) æ‰æ˜¯æœ‰æ•ˆç¡®è®¤ä¹¦ã€‚

**å½±å“**: DIV å èåˆæƒé‡ 55%, åœ¨ neutral ä¸­äº§ç”Ÿå¤§é‡æ— æ•ˆä¿¡å·, è¢«ç»“æ„æŠ˜æ‰£è¿‡æ»¤åä»ç„¶:
- å ç”¨å†·å´æœŸ (ghost signal æ¶ˆè€— cooldown æœºä¼š)
- äº§ç”Ÿæ‰‹ç»­è´¹ (å°ä»“ä½äº¤æ˜“çš„å›ºå®šæˆæœ¬æ¯”ä¾‹æ›´é«˜)
- å¢åŠ è·¯å¾„ä¾èµ– (å½±å“åç»­äº¤æ˜“æ—¶åº)

**å·²æœ‰ç¼“è§£**: ç»“æ„æŠ˜æ‰£ç³»ç»Ÿ (Â§6.2) å°† 0-2 æœ¬ç¡®è®¤çš„ä»“ä½å‹ç¼©åˆ° 0%-15%ã€‚
**P9 å°è¯•å¤±è´¥**: regime-adaptive SS/BS è°ƒæƒ (neutral: SSÃ—0.85, BSÃ—1.10) å¯¼è‡´ OOS é€€åŒ– -5.87%ã€‚

### 11.2 trend/high_vol ç©ºå•çš„ adverse selection

**IS æ•°æ®**:
- trend ç©ºå•: 12ç¬”, WR=25%, PnL=-$477
- high_vol ç©ºå•: 6ç¬”, WR=50%, PnL=-$130
- äºæŸå¤šå‘ç”Ÿåœ¨ 2-11 bars å†…å¿«é€Ÿæ­¢æŸ

**OOS æ•°æ®** (v8.0):
- trend ç©ºå•: 8ç¬”, WR=88%, PnL=+$1,339
- high_vol ç©ºå•: 4ç¬”, WR=100%, PnL=+$943

> **IS ä¸ OOS è¡¨ç°çŸ›ç›¾**: IS ä¸­ trend/high_vol short æ˜¯è´Ÿè´¡çŒ®, OOS ä¸­åè€Œæ˜¯æ­£è´¡çŒ®ã€‚
> è¿™è¯´æ˜é—®é¢˜ä¸åœ¨ç­–ç•¥é€»è¾‘, è€Œåœ¨ **regime æ—¶æœŸåˆ†å¸ƒ**: 2024å¹´(OOS)çš„ trend è¡Œæƒ…æœ‰åˆ©äºåšç©ºè·åˆ©,
> 2025å¹´(IS)çš„ trend è¡Œæƒ…ä¸­å¤šæ¬¡è¢«åå‘é€‰æ‹©ã€‚
> æ ·æœ¬é‡å¤ªå° (IS 18ç¬”, OOS 12ç¬”) æ— æ³•åšç»Ÿè®¡æ¨æ–­ã€‚

### 11.3 IS/OOS æ”¶ç›Šæ–¹å‘æ€§å·®å¼‚

IS: -12.58%, OOS: +41.40%, å·®å¼‚ 54 ä¸ªç™¾åˆ†ç‚¹ã€‚

**åŸå› åˆ†æ**:
- 2024å¹´ ETH æœ‰å¤šæ¬¡æ˜ç¡®è¶‹åŠ¿è¡Œæƒ… â†’ neutral_long å¤§é‡è·åˆ©
- 2025å¹´ ETH ä»¥éœ‡è¡ä¸ºä¸» â†’ neutral ä¸­ short è¯¯åˆ¤é¢‘ç¹
- Walk-forward 6 çª—å£ä¸­ 2 çª—å£äºæŸ, è¯´æ˜ç­–ç•¥å¯¹ regime æœ‰ä¾èµ–

### 11.4 å¾®ç»“æ„æ•°æ®è´¨é‡é—®é¢˜

å›æµ‹ä¸­æ‰€æœ‰å¾®ç»“æ„ç‰¹å¾ä½¿ç”¨ OHLCV æ´¾ç”Ÿçš„ä»£ç†å€¼:
- OI â†’ å›é€€åˆ° quote_volume
- funding â†’ å›é€€åˆ° basis Ã— 0.35
- basis â†’ å›é€€åˆ° (close - VWAP) / VWAP

è¿™æ„å‘³ç€:
- Anti-squeeze filter åœ¨å›æµ‹ä¸­å¯èƒ½äº§ç”Ÿ **è™šå‡çš„æœ‰æ•ˆæ€§æˆ–æ— æ•ˆæ€§**
- å¾®ç»“æ„å åŠ çš„ SS/BS è°ƒæ•´åŸºäºä»£ç†æ•°æ®, ç²¾åº¦æœ‰é™
- binance_fetcher.py å·²æœ‰è·å–çœŸå®æ•°æ®çš„å‡½æ•°, ä½†æœªæ•´åˆåˆ°å›æµ‹æµç¨‹

### 11.5 å°æ ·æœ¬é‡é™åˆ¶

| æ•°æ®é›† | äº¤æ˜“æ•° | ç»Ÿè®¡æ„ä¹‰ |
|--------|--------|---------|
| IS (13ä¸ªæœˆ) | 91 ç¬” | WR 95% CI: Â±10pp |
| OOS (12ä¸ªæœˆ) | 77 ç¬” | WR 95% CI: Â±11pp |
| IS trend short | 20 ç¬” | æ— ç»Ÿè®¡æ„ä¹‰ |
| IS high_vol short | 7 ç¬” | æ— ç»Ÿè®¡æ„ä¹‰ |

**å½±å“**: æ‹†åˆ†åˆ° regimeÃ—direction å, æ¯ç»„ <20 ç¬”, ä»»ä½•åŸºäºå­é›†çš„å‚æ•°ä¼˜åŒ–é«˜æ¦‚ç‡è¿‡æ‹Ÿåˆã€‚

### 11.6 Cliff Effect (P13 å·²ç¼“è§£)

åŸå§‹ç¦»æ•£è¿½è¸ª: short_trail = 0.19, 0.19 vs 0.20 å·® $15K (MFE å¯†é›†å †ç§¯åœ¨ 19%~20%)ã€‚
P13 è¿ç»­è¿½è¸ªæ­¢ç›ˆé€šè¿‡æ¸è¿›å¼å›æ’¤å®¹å¿ (60%â†’30%) æ¶ˆé™¤äº†ç¡¬é˜ˆå€¼, å·²åœ¨ç”Ÿäº§å¯ç”¨ã€‚

---

## åäºŒã€æœªæ¥ä¼˜åŒ–æ–¹å‘ (å¤šæ¨¡å‹å…±è¯†åˆ†æ)

åŸºäº Claude Opus / GPT Pro / Gemini / Grok çš„äº¤å‰åˆ†æåŠ v9.0.1 å›æµ‹å‘ç°, ä»¥ä¸‹æ˜¯æŒ‰ä¼˜å…ˆçº§æ’åºçš„æ”¹è¿›å»ºè®®:

### ğŸ”´ ç´§æ€¥: åŸºäº v5 å®Œæ•´å›æµ‹ç»“æœ (2026-02-15)

> v5 ç”Ÿäº§é…ç½® IS PF=0.898 < 1.0, éœ€ä¼˜å…ˆè¯„ä¼°æ˜¯å¦å›é€€æˆ–è°ƒæ•´ B1b/P24 å‚æ•°ã€‚

| ä¼˜å…ˆçº§ | ç¼–å· | æ–¹å‘ | é¢„æœŸæ”¶ç›Š | çŠ¶æ€ |
|--------|------|------|---------|------|
| **P0** | **P33** | **B1b è½¯åŒ–è¯„ä¼°**: neutral:999 æ”¹ä¸º neutral:70-80, ä¿ç•™é«˜ç½®ä¿¡ neutral short | æ¢å¤ IS +$985, PF>1.0 | **å¾…æ‰§è¡Œ** |
| **P0** | **P34** | **P24 æ­¢æŸæ”¾å®½**: trend SL ä» -15%â†’-18%, æˆ–æ”¹ç”¨ ATR-based åŠ¨æ€æ­¢æŸ | æ¢å¤ trend short åˆ©æ¶¦ ($374â†’$9k) | **å¾…æ‰§è¡Œ** |
| **P0** | **P35** | **OOS æ‰©å±•**: å¯»æ‰¾å« short äº¤æ˜“çš„ OOS çª—å£éªŒè¯ v9 æ–°ç‰¹æ€§ | è·å¾— B1b/P24 çš„ OOS è¯æ® | **å¾…æ‰§è¡Œ** |
| P0 | P25 | P18+P23 ç»„åˆ Walk-Forward éªŒè¯ | ç¡®è®¤ E4 OOS+28.9% æ³›åŒ–ç¨³å®šæ€§ | å¾…æ‰§è¡Œ |
| P0 | P26 | P21 R% è°ƒå‚ (2.5-3.5%) | æ¶ˆç­"å°‘æ•°å¤§äºå•ä¸»å¯¼" | å¾…æ‰§è¡Œ |

### åŸæœ‰ä¼˜å…ˆçº§è·¯çº¿å›¾ (å·²éƒ¨åˆ†å®ç°)

| ä¼˜å…ˆçº§ | ç¼–å· | æ–¹å‘ | çŠ¶æ€ |
|--------|------|------|------|
| P0 | çœŸå®æ°¸ç»­åˆçº¦æ•°æ®ç®¡é“ | æ•°æ®è·å–å‡½æ•°**å·²å®Œæˆ** (binance_fetcher.py), éœ€æ•´åˆåˆ°å›æµ‹ | **P28å¾…æ‰§è¡Œ** |
| P1 | MAE/MFE è¯Šæ–­è¿½è¸ª | ~15è¡Œä»£ç , è®°å½• min_pnl_r åˆ° trade dict | å¾…æ‰§è¡Œ |
| P1 | P27 Funding ç°é‡‘æµçº³å…¥å›æµ‹ | æ¶ˆé™¤æ”¶ç›Šè™šé«˜ (~2-5%) | å¾…æ‰§è¡Œ |
| P1 | P28 Anti-Squeeze å›æµ‹éªŒè¯ | ç”¨çœŸå® OI/Funding æ•°æ®éªŒè¯ | å¾…æ‰§è¡Œ |
| P2 | è´¹ç”¨å‹åŠ›æµ‹è¯• | feeÃ—2 + slippageÃ—2 ç¯å¢ƒéªŒè¯ | å¾…æ‰§è¡Œ |
| P2 | P29 CS-KDJ å»ç›¸å…³ | æ¶ˆé™¤è™šå‡å…±è¯† (r=0.474) | å¾…è®¾è®¡ |
| P2 | P30 Leg é£é™©é¢„ç®— | æŒ‰ regimeÃ—direction åˆ†é…èµ„æœ¬ | å¾…è®¾è®¡ |
| P3 | P31 åŠ¨æ€ Regime é˜ˆå€¼ | æ»šåŠ¨ç™¾åˆ†ä½æ›¿ä»£å›ºå®šå€¼ | å¾…è®¾è®¡ |
| P3 | P32 MAE-driven æ•°æ®é©±åŠ¨æ­¢æŸ | æ›¿ä»£å›ºå®šç™¾åˆ†æ¯” | å¾…è®¾è®¡ |

### é•¿æœŸæ¶æ„æ–¹å‘ (LLM å…±è¯†)

1. **ç­–ç•¥æ‹†è…¿ + ç»„åˆé£é™©é¢„ç®—**: æŒ‰ (regime Ã— direction) æ‹†æˆç‹¬ç«‹ legs, æ¯ä¸ª leg æœ‰ç‹¬ç«‹é£æ§ KPI å’Œé£é™©é¢„ç®—ã€‚B1b æ˜¯è¿™ä¸ªæ–¹å‘çš„é›å½¢ (æŠŠ neutral_short çš„ budget è®¾ä¸º 0)ã€‚
2. **ä» alpha ç­–ç•¥åˆ° hedge ç­–ç•¥**: short legs çš„ç›®æ ‡ä»"è¿½æ±‚ alpha"è½¬ä¸º"é™ä½ç»„åˆå°¾éƒ¨é£é™©"ã€‚ä»…åœ¨å´©ç›˜é£é™©ä¸Šå‡æ—¶å¼€ç©º (OI æ€¥å‡ + funding æç«¯ + liquidation flow)ã€‚
3. **æ›´çœŸå®çš„å›æµ‹å£å¾„**: feeÃ—2 / slippageÃ—2 å‹åŠ›æµ‹è¯•; æ»‘ç‚¹åˆ†å¸ƒæ¨¡å‹; Mark Price å¼ºå¹³ã€‚

### å·²è¯„ä¼°å¹¶æ”¾å¼ƒçš„æ–¹å‘

| æ–¹å‘ | è¯„ä¼°æ¥æº | æ”¾å¼ƒç†ç”± |
|------|---------|---------|
| ç­–ç•¥æ‹†æˆ 10 ä¸ª Legs | GPT Pro P0 | 91ç¬”/å¹´æ‹†10ç»„=æ¯ç»„9ç¬”, æ— ç»Ÿè®¡æ„ä¹‰; å·¥ç¨‹å¤æ‚åº¦3x |
| R-Based ä»“ä½ç®¡ç† | P21 ABæµ‹è¯• | 1.5% R% è¿‡ä¿å®ˆ, IS -10%; éœ€è°ƒå‚ä½†éç´§æ€¥ |
| P9 Regime-Adaptive SS/BSè°ƒæƒ | P9 ABæµ‹è¯• | OOSé€€åŒ–-5.87%, å·²éªŒè¯æ— æ•ˆ |
| åŠ¨æ€Regimeé˜ˆå€¼ | P12 ABæµ‹è¯• | OOSé€€åŒ–-1.23%, ä¸å€¼å¾—å¤æ‚åº¦ |
| Mark Price å›æµ‹ | GPT Pro 1.1 | ETH/USDT + 2-5xæ æ† + 1h bar, mark/lastå·®å¼‚<0.01% |
| Ghost Cooldown | P6 ABæµ‹è¯• | å›æµ‹ä¸­ä»æœªè§¦å‘ |
| Fast-failé€€å‡º | P10 ABæµ‹è¯• | ISè´Ÿå‘ |

---

## åä¸‰ã€å·²å…³é—­åŠŸèƒ½æ³¨å†Œè¡¨

ä»¥ä¸‹åŠŸèƒ½åœ¨ä»£ç ä¸­å­˜åœ¨ä½†é»˜è®¤å…³é—­ (use_*=False), ä¸ P6-P13 å®éªŒåŠŸèƒ½åˆ†å¼€åˆ—å‡º:

| åŠŸèƒ½ | é…ç½®å¼€å…³ | å…³é—­åŸå›  |
|------|---------|---------|
| ä¿æœ¬æ­¢æŸ (TP1åç§»SL) | `use_breakeven_after_tp1` | å‹åˆ¶åˆ©æ¶¦ |
| æ£˜è½®è¿½è¸ªæ­¢æŸ | `use_ratchet_trail` | ä¸ P13 å†²çª, åˆ©æ¶¦å¤§å¹…ä¸‹é™ |
| ä¿¡å·è´¨é‡æ­¢æŸ (å¼±ä¿¡å·ç´§SL) | `use_ss_quality_sl` | æ”¶ç›Šæ— æ•ˆ |
| ATRè‡ªé€‚åº”æ­¢æŸ | `use_atr_sl` | å¯¹ETHæ— æ•ˆ |
| Neutral è´¨é‡é—¨æ§ (äºŒå…ƒ) | `use_neutral_quality_gate` | OOSé€€åŒ– |
| å…­ä¹¦å…±è¯†é—¨æ§ (äºŒå…ƒ) | `use_neutral_book_consensus` | è¢«æ¸è¿›æŠ˜æ‰£æ›¿ä»£ |
| Neutral ç©ºå¤´ç»“æ„ç¡®è®¤å™¨ | `use_neutral_short_structure_gate` | è¿‡åº¦æ‹¦æˆª |
| ç©ºå•é€†åŠ¿é˜²å®ˆé€€å‡º | `use_short_adverse_exit` | æœªå……åˆ†éªŒè¯ |
| æç«¯èƒŒç¦»ç©ºå¦å†³ | `use_extreme_divergence_short_veto` | æœªå……åˆ†éªŒè¯ |
| ä¿¡å·ç½®ä¿¡åº¦å­¦ä¹ å±‚ | `use_confidence_learning` | å…ˆç”¨äºå¤ç›˜ |
| Neutral åˆ†å±‚ SPOT_SELL | `use_neutral_spot_sell_layer` | ä¸»æ ·æœ¬è´Ÿè´¡çŒ® |
| åœæ»å†å…¥åœº | `use_stagnation_reentry` | è§¦å‘å°‘ä¸”è´Ÿè´¡çŒ® |
| å¤šå¤´å†²çªè½¯æŠ˜æ‰£ | `use_long_conflict_soft_discount` | ä»…å®éªŒ |
| Long é«˜ç½®ä¿¡é—¨æ§ A/B | `use_long_high_conf_gate_a/b` | OOSæ­£å‘ä½†ä¸»åŒºé—´å›æ’¤ |
| P18 Regime-Adaptive Fusion | `use_regime_adaptive_fusion` | E4 OOS+28.9%, ä½† IS åˆ†è£‚ä¸¥é‡, å¾… WF éªŒè¯ |
| P21 R-based ä»“ä½ç®¡ç† | `use_risk_per_trade` | 1.5% R% è¿‡ä¿å®ˆ, IS-10%, éœ€è°ƒå‚ |
| P23 åŠ æƒç»“æ„ç¡®è®¤ | `use_weighted_confirms` | ç‹¬ç«‹ OOS-12.6%, ä»…ä¸ P18 ç»„åˆæœ‰æ•ˆ |

---

## é™„å½• A: å®Œæ•´å‚æ•°æ¸…å• (v9.0.1 / v5 éƒ¨ç½²å€¼)

```json
{
  "symbol": "ETHUSDT",
  "timeframe": "1h",
  "sell_threshold": 18,
  "buy_threshold": 25,
  "short_threshold": 40,
  "long_threshold": 25,
  "close_short_bs": 40,
  "close_long_ss": 40,
  "sell_pct": 0.55,
  "short_sl": -0.20,
  "short_tp": 0.60,
  "long_sl": -0.10,
  "long_tp": 0.40,
  "short_trail": 0.19,
  "long_trail": 0.12,
  "trail_pullback": 0.50,
  "use_partial_tp": true,
  "partial_tp_1": 0.15,
  "partial_tp_1_pct": 0.30,
  "use_partial_tp_2": true,
  "partial_tp_2": 0.50,
  "partial_tp_2_pct": 0.30,
  "use_partial_tp_v3": true,
  "partial_tp_1_early": 0.12,
  "partial_tp_2_early": 0.25,
  "hard_stop_loss": -0.28,
  "leverage": 5,
  "max_lev": 5,
  "margin_use": 0.70,
  "single_pct": 0.20,
  "total_pct": 0.50,
  "cooldown": 6,
  "spot_cooldown": 12,
  "short_max_hold": 48,
  "long_max_hold": 72,
  "reverse_min_hold_short": 8,
  "reverse_min_hold_long": 8,

  "fusion_mode": "c6_veto_4",
  "veto_threshold": 25,
  "div_weight": 0.55,
  "kdj_weight": 0.15,
  "kdj_bonus": 0.09,
  "kdj_strong_mult": 1.25,
  "kdj_normal_mult": 1.12,
  "kdj_reverse_mult": 0.70,
  "kdj_gate_threshold": 10,
  "bb_bonus": 0.10,
  "vp_bonus": 0.08,
  "cs_bonus": 0.06,
  "veto_dampen": 0.30,

  "decision_timeframes": ["15m", "1h", "4h", "24h"],
  "consensus_min_strength": 40,
  "coverage_min": 0.5,

  "use_regime_aware": true,
  "regime_lookback_bars": 48,
  "regime_vol_high": 0.020,
  "regime_vol_low": 0.007,
  "regime_trend_strong": 0.015,
  "regime_trend_weak": 0.006,
  "regime_atr_high": 0.018,
  "regime_short_threshold": "neutral:999",
  "use_regime_short_gate": true,
  "regime_short_gate_add": 35,
  "regime_short_gate_regimes": "low_vol_trend",

  "use_neutral_structural_discount": true,
  "neutral_struct_activity_thr": 10.0,
  "neutral_struct_discount_0": 0.00,
  "neutral_struct_discount_1": 0.05,
  "neutral_struct_discount_2": 0.15,
  "neutral_struct_discount_3": 0.50,
  "neutral_struct_discount_4plus": 1.00,
  "structural_discount_short_regimes": "neutral",

  "use_short_conflict_soft_discount": true,
  "short_conflict_regimes": "trend,high_vol",
  "short_conflict_div_buy_min": 50.0,
  "short_conflict_ma_sell_min": 12.0,
  "short_conflict_discount_mult": 0.60,

  "use_dual_engine": true,
  "trend_engine_entry_mult": 0.95,
  "trend_engine_exit_mult": 1.05,
  "trend_engine_hold_mult": 1.35,
  "trend_engine_risk_mult": 1.10,
  "reversion_engine_entry_mult": 1.12,
  "reversion_engine_exit_mult": 0.90,
  "reversion_engine_hold_mult": 0.70,
  "reversion_engine_risk_mult": 0.75,

  "use_microstructure": true,
  "micro_lookback_bars": 48,
  "micro_imbalance_threshold": 0.08,
  "micro_basis_crowded_z": 2.2,
  "micro_funding_proxy_mult": 0.35,
  "micro_score_boost": 0.08,
  "micro_score_dampen": 0.10,

  "use_vol_target": true,
  "vol_target_annual": 0.85,
  "vol_target_lookback_bars": 48,
  "vol_target_min_scale": 0.45,
  "vol_target_max_scale": 1.35,

  "use_continuous_trail": true,
  "continuous_trail_start_pnl": 0.05,
  "continuous_trail_max_pb": 0.60,
  "continuous_trail_min_pb": 0.30,
  "continuous_trail_max_pb_short": 0.40,

  "use_regime_adaptive_sl": true,
  "regime_neutral_short_sl": -0.12,
  "regime_trend_short_sl": -0.15,
  "regime_low_vol_trend_short_sl": -0.18,
  "regime_high_vol_short_sl": -0.12,
  "regime_high_vol_choppy_short_sl": -0.12,

  "anti_squeeze_fr_threshold": 0.0008,
  "anti_squeeze_oi_z_threshold": 1.0,
  "anti_squeeze_taker_imb_threshold": 0.12,

  "use_trend_enhance": true,
  "trend_floor_ratio": 0.50,
  "use_spot_sell_confirm": true,
  "spot_sell_confirm_ss": 35,
  "spot_sell_confirm_min": 3,
  "spot_sell_regime_block": "high_vol,trend"
}
```

---

## é™„å½• B: å…³é”®æºç æ–‡ä»¶ç´¢å¼•

### æ ¸å¿ƒå¼•æ“

| æ–‡ä»¶ | è¡Œæ•° | èŒè´£ |
|------|------|------|
| optimize_six_book.py | ~4900 | å›æµ‹æ ¸å¿ƒ: å« P18/P21/P23/P24/B1b/Anti-Squeeze å®Œæ•´å®ç° |
| signal_core.py | ~980 | ä¿¡å·èåˆ: `compute_signals_six()`, `calc_fusion_score_six_batch()`, `_fuse_scores()` (5ç§æ¨¡å¼) |
| multi_tf_consensus.py | ~640 | å¤šå‘¨æœŸå…±è¯†: `fuse_tf_scores()`, `compute_weighted_consensus()`, `_detect_resonance_chains()` |
| strategy_futures.py | ~570 | åˆçº¦å¼•æ“: `FuturesEngine`, `FuturesPosition`, è´¹ç”¨/å¼ºå¹³/èµ„é‡‘è´¹ç‡æ¨¡å‹ |
| live_config.py | ~980 | é…ç½®: `StrategyConfig` (100+ å‚æ•°), `STRATEGY_PARAM_VERSIONS` (v1-v5) |
| binance_fetcher.py | ~690 | Kçº¿ + Mark Price + Funding Rate + OI è·å–/åˆå¹¶/ç¼“å­˜ |
| live_signal_generator.py | ~675 | å®ç›˜ä¿¡å·: å« v9 è¡ç”Ÿå“æ•°æ®è·å– + åˆå¹¶ |

### å…­ä¹¦ç­–ç•¥æ¨¡å—

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| indicators.py | MACD(12/26/9), KDJ(9/3/3), CCI, RSI, ç»“æ„æ£€æµ‹ |
| ma_indicators.py | å‡çº¿ 17å½¢æ€ + Granville 8æ³•åˆ™ + åŠ å¯†è´§å¸å‘¨æœŸ |
| candlestick_patterns.py | èœ¡çƒ›å›¾ 30+ Nison å½¢æ€ + é‡èƒ½ç¡®è®¤ |
| bollinger_strategy.py | å¸ƒæ—å¸¦ %B/BandWidth/Squeeze/Wåº•Mé¡¶ |
| volume_price_strategy.py | é‡ä»· OBV/VWAP/MFI/A-D/Wyckoff |
| kdj_strategy.py | KDJ ä¹ç«  + KD-MACD + å¤šTFå…±æŒ¯ |
| turtle_strategy.py | æµ·é¾Ÿ Donchian/ATR/System1+2 |

### å›æµ‹å®éªŒ

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| run_p0_oos_validation.py | P0: OOS 2024å…¨å¹´éªŒè¯ + regimeå½’å›  |
| run_p1_p2_sensitivity.py | P1: Monte Carlo Â±10%æ‰°åŠ¨, P2: trailæ•æ„Ÿåº¦ |
| run_p3_exit_ablation.py | P3: 7ç§é€€å‡ºæ¶ˆèå®éªŒ |
| run_p4_book_analysis.py | P4: Cohen's dåˆ¤åˆ«åŠ› + ä¿¡å·ç›¸å…³æ€§ |
| run_p6_p10_ab.py | P6-P10+P13: 9å˜ä½“ç»¼åˆAB (ç¬¬ä¸€æ‰¹) |
| run_p9_p12_ab.py | P9+P12+P14: 8å˜ä½“AB (ç¬¬äºŒæ‰¹) |
| run_p15_walk_forward.py | P15: 6çª—å£Walk-ForwardéªŒè¯ |
| run_p16_signal_analysis.py | P16: 518ç¬”äº¤æ˜“ä¿¡å·æ‹†è§£ |

### æ•°æ®ä¸å®ç›˜

| æ–‡ä»¶ | èŒè´£ |
|------|------|
| binance_fetcher.py | Binance Kçº¿æ•°æ® + mark_price + funding_rate + OI |
| live_runner.py | å®ç›˜å…¥å£ + å¤šTFä¿¡å·æ£€æµ‹ + å…±è¯†ç®—æ³• |
| live_signal_generator.py | å®ç›˜ä¿¡å·ç”Ÿæˆå™¨ |
| app.py | Flask Web åº”ç”¨ + API è·¯ç”± |
| deploy.sh | è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬ |

---

## é™„å½• C: å›æµ‹å‡†ç¡®æ€§å®¡æŸ¥ç»“è®º

| æ£€æŸ¥é¡¹ | ç»“è®º |
|--------|------|
| ä¿¡å·å»¶è¿Ÿæ‰§è¡Œ (æ—  same-bar bias) | âœ… signal at bar[i-1] close â†’ execute at bar[i] open |
| Regime æ— å‰è§† | âœ… ä¼  idx-1, rolling æ•°æ®åªåˆ° idx-1 |
| æ»‘ç‚¹æ— é‡å¤æ‰£é™¤ | âœ… slippage_cost ä»…è¿½è¸ªä¸é‡å¤æ‰£ |
| Profit Factor å…¬å¼ | âœ… losses è¿‡æ»¤ç¡®ä¿ pnl â‰¤ 0 |
| ä¿è¯é‡‘ä¼šè®¡ | âœ… margin åœ¨ usdt å†…å†»ç»“, å¹³ä»“åªåŠ  PnL-fee |
| å¼ºå¹³æ£€æµ‹ | âœ… ç”¨ bar å†… high/low æå€¼ |
| åŒå‘æŒä»“äº’æ–¥ | âœ… æœ‰æµ‹è¯•ä¿è¯ |
| èµ„é‡‘è´¹ç‡è®¡ç®— | âœ… åŸºäºå½“å‰ä»·æ ¼ Ã— qty (ç¬¦åˆäº¤æ˜“æ‰€è§„åˆ™) |
| å¾®é‡ç²¾åº¦æŸå¤± | âš ï¸ å¼ºå¹³ PnL é«˜ä¼° ~$12.5/ç¬” (maintenance margin æœªæ‰£) |
| å¾®ç»“æ„æ•°æ®æ¥æº | âš ï¸ å…¨éƒ¨ä½¿ç”¨ä»£ç†å€¼, éçœŸå®åˆçº¦æ•°æ® |
| Funding æ¨¡å‹ | âš ï¸ å›ºå®š0.01%/8h, çœŸå®å€¼å¯è¾¾0.1%+/8h |
| æ‰§è¡Œä»·å‡è®¾ | âš ï¸ ä½¿ç”¨ä¸‹æ ¹bar open, é«˜æ³¢åŠ¨æ—¶çœŸå®æˆäº¤ä»·å¯èƒ½åå·® |

---

## é™„å½• D: ç‰ˆæœ¬å˜æ›´æ‘˜è¦

### v6.0 â†’ v7.0 B3

| å‚æ•° | v6.0 | v7.0 B3 | å˜æ›´åŸå›  |
|------|------|---------|---------|
| cooldown | 4 | **6** | è¿‘ä¼¼ ghost cooldown, OOS +5.6% |
| regime_short_threshold | neutral:45 | **neutral:60** | P4å®è¯ neutral short æ—  alpha |
| short_conflict_regimes | trend,high_vol | **+neutral** | æ‰©å±•å†²çªæŠ˜æ‰£è¦†ç›– |
| neutral_struct_discount_0 | 0.10 | **0.00** | 0æœ¬ç¡®è®¤ç›´æ¥ç¦æ­¢ |
| neutral_struct_discount_1 | 0.20 | **0.05** | æ›´æ¿€è¿›æŠ˜æ‰£ |
| neutral_struct_discount_2 | 1.00 | **0.15** | æ–°å¢æ¢¯åº¦ |
| neutral_struct_discount_3 | (æ— ) | **0.50** | æ–°å¢æ¢¯åº¦ |

### v7.0 B3 â†’ v8.0/v8.1

| å˜æ›´ | è¯´æ˜ | ABéªŒè¯ |
|------|------|--------|
| **P13 å¯ç”¨** | è¿ç»­è¿½è¸ªæ­¢ç›ˆ (start=5%, pb 60%â†’30%) | IS PF +18.7%, OOS WR +3.9pp |
| P6-P13 å®ç° | 7ä¸ªå®éªŒç‰¹æ€§ä»£ç å°±ç»ª, é…ç½®é»˜è®¤å…³é—­ | å„è‡ªABéªŒè¯å®Œæˆ |
| å®Œæ•´ABæµ‹è¯•å¥—ä»¶ | P0-P16 å…±8ä¸ªå®éªŒè„šæœ¬, è¦†ç›–IS+OOS | ç»“æœå­˜å‚¨åœ¨ data/backtests/ |
| Walk-Forward | 6çª—å£æ»šåŠ¨éªŒè¯ | 4/6ç›ˆåˆ©, avg +9.58%/Q |

### v8.1 â†’ v9.0 (live_config.py v5, ç”Ÿäº§é»˜è®¤)

| å˜æ›´ | è¯´æ˜ | éªŒè¯çŠ¶æ€ |
|------|------|---------|
| B1b: ç¦æ­¢ neutral short | regime_short_threshold='neutral:999' | âš ï¸ IS è¯¯æ€ç›ˆåˆ©ä¿¡å· |
| P20: Short è¿½è¸ªæ”¶ç´§ | continuous_trail_max_pb_short=0.40 | IS+5.6%, OOSæ— å½±å“ |
| P24: Regime-adaptive SL | trend:-15%, high_vol:-12% | âš ï¸ trend profit -96% |
| Anti-Squeeze V9 | fr>0.08% + oi_z>1.0 + taker>12% â†’ block short | å›æµ‹ä½¿ç”¨ä»£ç†æ•°æ® |
| å†²çªæŠ˜æ‰£ç®€åŒ– | ä» trend,high_vol,neutral â†’ trend,high_vol | å›  B1b neutral ä¸å¯è¾¾ |
| è¡ç”Ÿå“æ•°æ®è·å– | binance_fetcher: mark/funding/OI å®Œæ•´API | live_signal_generator å·²é›†æˆ |
| P18 å®ç°(æœªå¯ç”¨) | regime-adaptiveèåˆæƒé‡, L1124-1131, L2191-2208 | E4 OOS+28.9% ä½† IS åˆ†è£‚ |
| P21 å®ç°(æœªå¯ç”¨) | R-based ä»“ä½ç®¡ç†, L1948-1991 | 1.5% R% è¿‡ä¿å®ˆ |
| P23 å®ç°(æœªå¯ç”¨) | åŠ æƒç»“æ„ç¡®è®¤, L1034-1105 | ç‹¬ç«‹æ•ˆæœå·®, ä¸P18ç»„åˆå¥½ |

### v9.0 â†’ v9.0.1 (å›æµ‹éªŒè¯, 2026-02-15)

| å‘ç° | å½±å“ | å»ºè®®è¡ŒåŠ¨ |
|------|------|---------|
| IS PF=0.898 (<1.0) | v5 é…ç½® IS ç›ˆäºæ¯”å‡€äºæŸ | P33: B1bè½¯åŒ–, P34: P24æ”¾å®½ |
| B1b è¯¯æ€ neutral short | IS WR=68% PnL=+$985 è¢«ç¦æ­¢ | è¯„ä¼° neutral:70-80 |
| P24 æˆªæ–­ trend profit | $9,121â†’$374 | å›é€€ -15%â†’-18% |
| OOS æ—  short äº¤æ˜“ | v9 æ–°ç‰¹æ€§é›¶éªŒè¯ | P35: æ‰©å±• OOS çª—å£ |

---

## é™„å½• E: AB æµ‹è¯•å®Œæ•´æ•°æ®

### E.1 P6-P10+P13 Regime æ‹†è§£ (IS, v7.0 B3 åŸºçº¿)

| SideÃ—Regime | C0åŸºçº¿ N | C0 WR | C0 PnL | C6 P13 N | C6 WR | C6 PnL |
|-------------|---------|-------|--------|---------|-------|--------|
| short\|trend | 12 | 25% | -$477 | 20 | 40% | -$1,656 |
| short\|neutral | 26 | 54% | -$2,287 | 30 | 47% | +$1,446 |
| short\|high_vol | 6 | 50% | -$130 | 7 | 57% | -$39 |
| long\|neutral | 5 | 80% | +$500 | 4 | 100% | +$525 |
| long\|trend | 1 | 100% | +$118 | 1 | 100% | +$211 |
| short\|low_vol_trend | 2 | 100% | +$340 | 3 | 67% | -$83 |

> **P13 çš„æ ¸å¿ƒæ”¹å–„**: neutral short ä» PnL=-$2,287 ç¿»è½¬ä¸º +$1,446ã€‚
> æœºåˆ¶: è¿ç»­è¿½è¸ªä½¿å¾—å°åˆ©æ¶¦äº¤æ˜“åŠæ—¶é”å®š, å‡å°‘å›åã€‚

### E.2 P6-P10+P13 Regime æ‹†è§£ (OOS)

| SideÃ—Regime | C0åŸºçº¿ N | C0 PnL | C6 P13 N | C6 PnL |
|-------------|---------|--------|---------|--------|
| long\|neutral | 9 | +$2,193 | 9 | +$2,010 |
| short\|neutral | 17 | +$635 | 13 | +$536 |
| short\|trend | 8 | +$477 | 8 | +$1,339 |
| short\|high_vol | 1 | +$404 | 4 | +$943 |
| long\|low_vol_trend | 3 | +$1,248 | 3 | +$1,062 |

### E.3 Walk-Forward è¯¦ç»†æ•°æ®

ç­–ç•¥é…ç½®: v8.0 (B3 + P13), 6ä¸ªæœˆè®­ç»ƒ / 3ä¸ªæœˆæµ‹è¯•, 6ä¸ªæ»šåŠ¨çª—å£ã€‚

```
W1: Train 2024-01~06 (+45.1% WR=71.2%) â†’ Test 2024-07~09 (-3.14% WR=58.8% PF=2.29 MDD=-12.22%)
W2: Train 2024-04~09 (-13.9% WR=57.4%) â†’ Test 2024-10~12 (+27.72% WR=62.0% PF=1.91 MDD=-6.51%)
W3: Train 2024-07~12 (-8.17% WR=64.3%) â†’ Test 2025-01~03 (-11.96% WR=69.8% PF=1.13 MDD=-14.98%)
W4: Train 2024-10~03 (+18.2% WR=63.0%) â†’ Test 2025-04~06 (+39.02% WR=59.0% PF=1.47 MDD=-11.10%)
W5: Train 2025-01~06 (-11.3% WR=63.6%) â†’ Test 2025-07~09 (+15.37% WR=54.3% PF=0.39 MDD=-7.29%)
W6: Train 2025-04~09 (+12.7% WR=48.3%) â†’ Test 2025-10~12 (-9.55% WR=60.0% PF=3.42 MDD=-14.09%)
```

### E.4 ä¿¡å·åˆ†ææ‘˜è¦ (P16)

518 ç¬”äº¤æ˜“çš„ä¿¡å·æ‹†è§£ (IS+OOS åˆå¹¶):
- DIV ä¸ PnL ç›¸å…³æ€§: r â‰ˆ -0.02 (neutral) ~ +0.08 (trend)
- MA ä¸ PnL ç›¸å…³æ€§: r â‰ˆ +0.15
- CS ä¸ PnL ç›¸å…³æ€§: r â‰ˆ +0.22 (æœ€é«˜)
- KDJ ä¸ PnL ç›¸å…³æ€§: r â‰ˆ +0.18
- ä¹¦é—´ç›¸å…³æ€§: 0.25~0.60 (ä¸­ä½), æ— ä¸¥é‡å…±çº¿æ€§
- CS-KDJ ç›¸å…³æ€§: 0.474 (æœ€é«˜å¯¹)

### E.5 v9.0 å®Œæ•´å›æµ‹æ•°æ® (v5 ç”Ÿäº§é…ç½®éªŒè¯)

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_full_backtest_20260215_184527.csv`

```
E0_v8_baseline:   IS ret=+67.34%  WR=56.86%  PF=1.181  MDD=-11.89%  trades=153
                  OOS ret=-3.83%   WR=65.12%  PF=1.589  MDD=-26.69%  trades=43
E1_v9_v5_prod:    IS ret=+46.63%  WR=56.36%  PF=0.898  MDD=-14.93%  trades=110
                  OOS ret=-3.83%   WR=65.12%  PF=1.589  MDD=-26.69%  trades=43
E2_v5_P18lite:    IS ret=-14.45%  WR=53.85%  PF=0.443  MDD=-19.56%  trades=26
                  OOS ret=+41.11%  WR=68.42%  PF=2.271  MDD=-16.89%  trades=76
E3_v5_P18_P23:    IS ret=+5.02%   WR=59.21%  PF=0.707  MDD=-16.99%  trades=76
                  OOS ret=+37.75%  WR=69.33%  PF=2.132  MDD=-16.54%  trades=75
```

**E0 IS Regime æ˜ç»†** (v8 åŸºçº¿):
- short|neutral: n=34, w=23 (68%), PnL=+$985
- short|trend: n=14, w=9 (64%), PnL=+$9,121
- short|low_vol_trend: n=5, w=2 (40%), PnL=-$4,529
- long|neutral: n=27, w=13 (48%), PnL=-$374
- long|trend: n=6, w=5 (83%), PnL=+$6,855

**E1 IS Regime æ˜ç»†** (v5 ç”Ÿäº§):
- short|trend: n=13, w=10 (77%), PnL=+$374 â† P24 æˆªæ–­
- short|low_vol_trend: n=3, w=1 (33%), PnL=-$546
- long|neutral: n=28, w=16 (57%), PnL=+$3,589 â† B1b é‡Šæ”¾å®¹é‡
- long|trend: n=6, w=6 (100%), PnL=+$4,423

### E.6 v9.0 å•ç‰¹æ€§éš”ç¦»æµ‹è¯•

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_ab_20260215_164522.csv`

```
D0_v8_baseline:              IS +48.23%  PF=0.916  trades=159 | OOS -3.55%  PF=1.679  trades=43
D1_p18_regime_fusion:        IS -10.71%  PF=1.438  trades=39  | OOS +12.75% PF=1.263  trades=70
D2_p24_regime_sl:            IS +43.77%  PF=0.859  trades=160 | OOS -3.55%  PF=1.679  trades=43
D3_p20_short_trail_tight:    IS +53.80%  PF=0.955  trades=150 | OOS -3.55%  PF=1.679  trades=43
D4_b1b_block_neutral_short:  IS +44.50%  PF=0.842  trades=92  | OOS -3.55%  PF=1.679  trades=43
D7_b1b_p20:                  IS +42.98%  PF=0.822  trades=90  | OOS -3.55%  PF=1.679  trades=43
D8_p18_p24_p20_b1b:          IS -6.87%   PF=0.946  trades=22  | OOS +12.41% PF=1.184  trades=60
```

### E.7 v9.0 Round 3: P18/P21/P23 ç»„åˆå®éªŒ

**æ•°æ®æ¥æº**: `data/backtests/v9_ab/v9_ab_r3_20260215_180525.csv`

```
E0_baseline_fixed:   IS +65.74%  PF=1.140  trades=154 | OOS -3.32%  PF=1.672  trades=43  Worst5=-$15,069
E1_P23_weighted:     IS +43.21%  PF=0.954  trades=143 | OOS -12.64% PF=0.725  trades=42  Worst5=-$15,649
E2_P21_risk_R:       IS -9.95%   PF=0.238  trades=17  | OOS +0.06%  PF=1.611  trades=43  Worst5=-$10,028
E4_P18lite_P23:      IS -6.22%   PF=0.943  trades=81  | OOS +28.91% PF=1.327  trades=107 Worst5=-$13,215
E5_full_v9:          IS -4.19%   PF=1.179  trades=83  | OOS +12.74% PF=1.087  trades=110 Worst5=-$7,021
```

> **æ³¨**: E4/E5 çš„ OOS trades ä» 43â†’107/110, è¯´æ˜ P18 æ¿€æ´»äº† short äº¤æ˜“ (v8 åŸºçº¿ OOS æ—  short)ã€‚
> E5 full v9 çš„ Worst-5 ä» -$15,069 é™è‡³ -$7,021, å°¾éƒ¨é£é™©å¤§å¹…æ”¹å–„ã€‚
