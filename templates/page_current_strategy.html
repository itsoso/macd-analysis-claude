{% extends "base.html" %}
{% block title %}å½“å‰æœ€ä¼˜ç­–ç•¥(v4) - æŠ€æœ¯åˆ†æå¹³å°{% endblock %}

{% block content %}
<style>
    .strategy-hero {
        background: linear-gradient(135deg, rgba(74,158,255,0.12), rgba(168,85,247,0.08));
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 28px 32px;
        margin-bottom: 28px;
    }
    .strategy-hero h1 { font-size: 26px; font-weight: 700; margin-bottom: 8px; }
    .strategy-hero .tagline { font-size: 14px; color: var(--text-secondary); margin-bottom: 20px; }
    .strategy-meta {
        display: flex; flex-wrap: wrap; gap: 12px;
    }
    .strategy-meta .badge {
        padding: 6px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
    }
    .strategy-meta .badge.blue { background: rgba(74,158,255,0.2); color: var(--accent-blue); }
    .strategy-meta .badge.green { background: rgba(0,214,143,0.2); color: var(--accent-green); }
    .strategy-meta .badge.purple { background: rgba(168,85,247,0.2); color: var(--accent-purple); }
    .strategy-meta .badge.yellow { background: rgba(255,170,0,0.2); color: var(--accent-yellow); }

    .section h3 {
        font-size: 16px; font-weight: 600; margin-bottom: 12px;
        display: flex; align-items: center; gap: 8px;
    }
    .section { margin-bottom: 24px; }
    .section ul { margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 14px; line-height: 1.8; }
    .section .param-table {
        width: 100%; border-collapse: collapse; font-size: 13px; margin-top: 8px;
    }
    .section .param-table th, .section .param-table td {
        text-align: left; padding: 8px 12px; border-bottom: 1px solid var(--border);
    }
    .section .param-table th { color: var(--text-muted); font-weight: 600; }
    .section .param-table code { background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px; }
    .monitor-tip {
        background: rgba(255,170,0,0.1); border: 1px solid rgba(255,170,0,0.3);
        border-radius: 10px; padding: 16px; margin-top: 16px; font-size: 13px; color: var(--text-secondary);
    }
    .monitor-tip strong { color: var(--accent-yellow); }
    .evolution-timeline {
        display: flex; flex-direction: column; gap: 0; margin: 16px 0; font-size: 13px;
    }
    .evolution-item {
        display: flex; gap: 16px; padding: 12px 0;
        border-left: 2px solid var(--border); margin-left: 12px; padding-left: 20px;
        position: relative; color: var(--text-secondary); line-height: 1.6;
    }
    .evolution-item::before {
        content: ''; position: absolute; left: -6px; top: 16px;
        width: 10px; height: 10px; border-radius: 50%; background: var(--border);
    }
    .evolution-item.active { border-left-color: var(--accent-blue); }
    .evolution-item.active::before { background: var(--accent-blue); box-shadow: 0 0 8px rgba(74,158,255,0.5); }
    .evolution-tag { font-weight: 600; color: var(--text-primary); min-width: 32px; }
    .ab-result { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
    .ab-card {
        background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px;
        padding: 12px; font-size: 12px; color: var(--text-secondary);
    }
    .ab-card .ab-label { font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
    .ab-card .ab-verdict { font-weight: 600; margin-top: 4px; }
    .ab-card .ab-verdict.keep { color: var(--accent-green); }
    .ab-card .ab-verdict.drop { color: var(--accent-red); }
</style>

<div class="strategy-hero">
    <h1>ğŸ“Œ å½“å‰æœ€ä¼˜ç­–ç•¥ï¼ˆv4 â€” param_sweep ç³»ç»Ÿæ€§ä¼˜åŒ–ï¼‰</h1>
    <p class="tagline">å…­ä¹¦èåˆ Â· å¤šå‘¨æœŸè”åˆå†³ç­– Â· ETH/USDT Â· ä¸é€æ—¥å›æµ‹ Run#33 ä¸€è‡´ Â· ç»“æ„åŒ–è§‚æµ‹é“¾è·¯</p>
    <div class="strategy-meta">
        <span class="badge blue">å†³ç­–å‘¨æœŸ 15m / 1h / 4h / 24h</span>
        <span class="badge green">åˆ†æ®µæ­¢ç›ˆ v3ï¼ˆ+12% / +25%ï¼‰</span>
        <span class="badge purple">Regime åŠ¨æ€é˜ˆå€¼</span>
        <span class="badge yellow">ç»“æ„åŒ–è½åº“ ss/bs/atr/regime</span>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ¯ ç­–ç•¥æ¦‚è¦</h3>
    <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.7; margin-bottom: 16px;">
        åŸºäºå…­ç»´èåˆè¯„åˆ†ï¼ˆèƒŒç¦»ã€å‡çº¿ã€èœ¡çƒ›å›¾ã€å¸ƒæ—å¸¦ã€é‡ä»·ã€KDJï¼‰åœ¨å¤šä¸ªæ—¶é—´æ¡†æ¶ä¸Šå¹¶è¡Œè®¡ç®—<strong>å–å‡ºåˆ†ï¼ˆSSï¼‰</strong>ä¸<strong>ä¹°å…¥åˆ†ï¼ˆBSï¼‰</strong>ï¼Œ
        é€šè¿‡å¤šå‘¨æœŸå…±è¯†ä¸è¶‹åŠ¿/Regime åŠ¨æ€é˜ˆå€¼å†³å®šå¼€å¹³ä»“ã€‚v4 åœ¨ v3 æ—©é”åˆ©åŸºç¡€ä¸Šï¼Œé€šè¿‡ 33 ç»„ param_sweep ç³»ç»Ÿæ€§ä¼˜åŒ–ï¼Œæ”¶ç›Š +15.6%ã€å›æ’¤æ”¹å–„ 27%ã€‚
    </p>
    <ul>
        <li><strong>å¼€ç©º</strong>ï¼šSS â‰¥ 25ï¼ˆv4 é™ä½é—¨æ§›ï¼Œå¢åŠ åšç©ºæœºä¼šï¼‰ï¼Œä¸”å–æ–¹ä¼˜åŠ¿æ»¡è¶³ dominanceï¼Œæ— å†²çªã€é£æ§ä¸å¾®ç»“æ„æœªæ‹¦æˆªã€‚</li>
        <li><strong>å¼€å¤š</strong>ï¼šBS â‰¥ 30ï¼ˆlong_thresholdï¼‰ï¼Œä¸”ä¹°æ–¹ä¼˜åŠ¿æ»¡è¶³ dominanceã€‚</li>
        <li><strong>å–å‡ºç°è´§</strong>ï¼šSS â‰¥ 18ï¼ˆsell_thresholdï¼‰ï¼Œå†·å´ä¸è¶‹åŠ¿åº•çº¿æ»¡è¶³ã€‚</li>
        <li><strong>å›ºå®šæ­¢æŸ</strong>ï¼šåšç©º -25%ï¼ˆv4 æ”¾å®½ï¼‰ï¼Œåšå¤š -10%ï¼ˆv4 æ”¾å®½ï¼‰ï¼›ATR åŠ¨æ€æ­¢æŸå…³é—­ï¼ˆA/B è¯æ˜å¯¹ ETH æ— æ•ˆï¼‰ã€‚</li>
        <li><strong>åˆ†æ®µæ­¢ç›ˆ v3</strong>ï¼šåšç©º TP1 åœ¨ +12% å¹³ 30%ï¼ŒTP2 åœ¨ +25% å†å¹³ 30%ï¼›åšå¤šåŒç†ã€‚</li>
        <li><strong>è¿½è¸ªæ­¢æŸ</strong>ï¼šåšç©º trailing 15%ï¼ˆv4 æ”¶ç´§ï¼‰ï¼Œåšå¤š 12%ï¼Œå›æ’¤æ¯” 50%ã€‚</li>
        <li><strong>ç»“æ„åŒ–è§‚æµ‹</strong>ï¼šæ¯ç¬”äº¤æ˜“è‡ªåŠ¨è®°å½• ss/bs/atr_pct/regime_label åˆ° DBï¼Œæ”¯æŒç²¾ç¡®å½’å› åˆ†æã€‚</li>
    </ul>
</div>

<div class="card">
    <h3 class="card-title">ğŸ“Š å›æµ‹å‚è€ƒï¼ˆRun#33ï¼Œ2025-01ï½2026-01ï¼‰</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">ç­–ç•¥æ”¶ç›Š</div>
            <div class="stat-value positive">+858.10%</div>
            <div class="stat-note">vs ä¹°å…¥æŒæœ‰ -13.55%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Alpha</div>
            <div class="stat-value positive">+871.65%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">æœ€å¤§å›æ’¤</div>
            <div class="stat-value" style="color: var(--accent-yellow);">-8.47%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">åˆçº¦ PF</div>
            <div class="stat-value">1.07</div>
            <div class="stat-note">ä»… CLOSE_LONG/SHORT</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">ç»„åˆ PF</div>
            <div class="stat-value positive">1.92</div>
            <div class="stat-note">å« PARTIAL_TP / SPOT_SELL</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">èƒœç‡</div>
            <div class="stat-value">63.5%</div>
            <div class="stat-note">249 æ¬¡å¹³ä»“</div>
        </div>
    </div>
    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Regime åˆ†æ®µè¡¨ç°</h4>
    <table class="param-table">
        <thead><tr><th>Regime</th><th>ç¬”æ•°</th><th>å‡€ PnL</th><th>pPF</th><th>è¯´æ˜</th></tr></thead>
        <tbody>
            <tr><td>neutral</td><td>276</td><td class="pnl-pos">+$379,532</td><td>2.99</td><td>ä¸»è¦åˆ©æ¶¦æ¥æº</td></tr>
            <tr><td>high_vol</td><td>44</td><td class="pnl-pos">+$100,773</td><td>4.47</td><td>é«˜æ³¢åŠ¨è¡Œæƒ…è·åˆ©ä¸°åš</td></tr>
            <tr><td>trend</td><td>145</td><td class="pnl-pos">+$82,470</td><td>1.30</td><td>è¶‹åŠ¿è¡Œæƒ…ç›ˆåˆ©ä½†æ­¢æŸè¾ƒå¤š</td></tr>
            <tr><td>low_vol_trend</td><td>65</td><td class="pnl-pos">+$8,011</td><td>1.06</td><td>ä½æ³¢åŠ¨è¶‹åŠ¿è¿‘å¹³ï¼Œ73% æ­¢æŸæ¥æº</td></tr>
            <tr><td>high_vol_choppy</td><td>5</td><td class="pnl-pos">+$4,612</td><td>14.27</td><td>ç½•è§çŠ¶æ€</td></tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h3 class="card-title">âš™ï¸ å…³é”®å‚æ•°ï¼ˆv4 â€” param_sweep ä¼˜åŒ–åï¼‰</h3>
    <table class="param-table">
        <thead>
            <tr><th>å‚æ•°</th><th>v4 å€¼</th><th>v3 å€¼</th><th>å˜åŒ–è¯´æ˜</th></tr>
        </thead>
        <tbody>
            <tr><td><code>short_threshold</code></td><td><strong>25</strong></td><td>35</td><td>é™ä½é—¨æ§›ï¼Œå¢åŠ åšç©ºæœºä¼š</td></tr>
            <tr><td><code>long_threshold</code></td><td>30</td><td>30</td><td>ä¸å˜</td></tr>
            <tr><td><code>short_sl</code></td><td><strong>-25%</strong></td><td>-18%</td><td>æ”¾å®½æ­¢æŸï¼Œå‡å°‘å‡çªç ´å‡ºå±€</td></tr>
            <tr><td><code>short_tp</code></td><td><strong>60%</strong></td><td>50%</td><td>ç›®æ ‡æ›´é«˜ï¼Œé…åˆè¿½è¸ªæ­¢æŸ</td></tr>
            <tr><td><code>long_sl</code></td><td><strong>-10%</strong></td><td>-8%</td><td>æ”¾å®½åšå¤šæ­¢æŸ</td></tr>
            <tr><td><code>short_trail</code></td><td><strong>15%</strong></td><td>25%</td><td>æ”¶ç´§è¿½è¸ªï¼Œæ›´å¿«é”åˆ©</td></tr>
            <tr><td><code>long_trail</code></td><td><strong>12%</strong></td><td>20%</td><td>æ”¶ç´§è¿½è¸ª</td></tr>
            <tr><td><code>trail_pullback</code></td><td><strong>50%</strong></td><td>60%</td><td>æ›´æ•æ„Ÿçš„å›æ’¤è§¦å‘</td></tr>
            <tr><td><code>partial_tp_1_early</code></td><td>12%</td><td>12%</td><td>v3 æ—©é”åˆ©ä¿ç•™</td></tr>
            <tr><td><code>partial_tp_2_early</code></td><td>25%</td><td>25%</td><td>v3 æ—©é”åˆ©ä¿ç•™</td></tr>
            <tr><td><code>use_atr_sl</code></td><td>å…³</td><td>å…³</td><td>A/B + param_sweep åŒé‡éªŒè¯æ— æ•ˆ</td></tr>
            <tr><td><code>use_regime_short_gate</code></td><td>å…³</td><td>â€”</td><td>æ–°å¢ regime åšç©ºé—¨æ§ï¼Œå›æ’¤æ”¹å–„ 0.15% ä½†æ”¶ç›Šé™ 50+pp</td></tr>
            <tr><td><code>use_spot_sell_cap</code></td><td>å…³</td><td>â€”</td><td>æ¯”ä¾‹é™å–å®æµ‹å‰Šå¼±æ”¶ç›Šï¼Œä¸å¯ç”¨</td></tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h3 class="card-title">ğŸ”¬ ç¬¬ä¸‰è½® A/B æ¶ˆèéªŒè¯</h3>
    <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
        å¯¹ v4 åŸºçº¿è¿›è¡Œ 9 ç»„æ¶ˆèæµ‹è¯•ï¼ŒéªŒè¯æ¯ä¸ªåŠŸèƒ½æ¨¡å—çš„è¾¹é™…è´¡çŒ®ï¼š
    </p>
    <div class="ab-result">
        <div class="ab-card">
            <div class="ab-label">æ—©æœŸé”åˆ© (v3)</div>
            <p>v4 vs v2(æ— æ—©é”): +858% vs +601%</p>
            <div class="ab-verdict keep">ä¿ç•™ â€” è´¡çŒ® +257pp æ”¶ç›Š</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">ATR åŠ¨æ€æ­¢æŸ</div>
            <p>åˆçº¦ PF é™è‡³ 0.99ï¼ˆè·Œç ´ 1.0ï¼‰</p>
            <div class="ab-verdict drop">å…³é—­ â€” å¯¹ ETH æœ‰å®³</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">Regime åšç©ºé—¨æ§</div>
            <p>å›æ’¤ -8.32%ï¼ˆæ”¹å–„ 0.15%ï¼‰ï¼Œæ”¶ç›Šé™ ~50pp</p>
            <div class="ab-verdict drop">å…³é—­ â€” æ€§ä»·æ¯”ä¸è¶³</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">SPOT_SELL æ¯”ä¾‹ä¸Šé™</div>
            <p>cap30%: SPOT_SELL PnL ä» $334k é™è‡³ $253k</p>
            <div class="ab-verdict drop">å…³é—­ â€” å‰Šå¼±æ ¸å¿ƒæ”¶ç›Š</div>
        </div>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ“ˆ ç­–ç•¥æ¼”è¿›è·¯çº¿</h3>
    <div class="evolution-timeline">
        <div class="evolution-item">
            <span class="evolution-tag">v1</span>
            <div>åŸºç¡€å…­ä¹¦èåˆç­–ç•¥ï¼Œå›ºå®šé˜ˆå€¼ + å›ºå®šæ­¢ç›ˆæ­¢æŸã€‚æ”¶ç›Š +600%ã€‚</div>
        </div>
        <div class="evolution-item">
            <span class="evolution-tag">v2</span>
            <div>å¼•å…¥å¤šå‘¨æœŸå…±è¯†ã€Regime åŠ¨æ€é˜ˆå€¼ã€å¾®ç»“æ„è¿‡æ»¤ã€‚æ”¶ç›Š +600%ï¼Œå›æ’¤æ”¹å–„ã€‚</div>
        </div>
        <div class="evolution-item">
            <span class="evolution-tag">v3</span>
            <div>æ—©æœŸåˆ†æ®µé”åˆ©ï¼ˆ+12%/+25%ï¼‰ï¼Œæ”¶ç›Šè·ƒå‡è‡³ +806%ï¼Œå›æ’¤ -10.26%ã€‚</div>
        </div>
        <div class="evolution-item active">
            <span class="evolution-tag">v4</span>
            <div>param_sweep 33 ç»„ç³»ç»Ÿæ€§ä¼˜åŒ–ï¼šçŸ­é˜ˆå€¼é™è‡³ 25ã€æ­¢æŸæ”¾å®½è‡³ -25%ã€è¿½è¸ªæ”¶ç´§è‡³ 15%/12%ã€‚
                æ”¶ç›Š +858%ï¼ˆ+52ppï¼‰ï¼Œå›æ’¤ -8.47%ï¼ˆæ”¹å–„ 1.79ppï¼‰ã€‚ç»“æ„åŒ–è§‚æµ‹é“¾è·¯è½åº“ã€‚</div>
        </div>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ”— ç›¸å…³é¡µé¢</h3>
    <p style="color: var(--text-secondary); font-size: 14px;">
        <a href="/strategy/live-control" style="color: var(--accent-blue);">å®ç›˜æ§åˆ¶é¢æ¿</a> Â·
        <a href="/strategy/multi-tf-daily" style="color: var(--accent-blue);">å¤šå‘¨æœŸÂ·é€æ—¥ç›ˆäº</a> Â·
        <a href="/strategy/multi-tf-deep-dive" style="color: var(--accent-blue);">å¤šå‘¨æœŸè”åˆå†³ç­–Â·ä»£ç è¯¦è§£</a> Â·
        <a href="/strategy/multi-tf-date-range-report" style="color: var(--accent-blue);">å¤šå‘¨æœŸåŒºé—´å›æµ‹(DB)</a>
    </p>
    <div class="monitor-tip">
        <strong>å®ç›˜æ§åˆ¶é¢æ¿å»ºè®®</strong>ï¼šå¤šå‘¨æœŸä¿¡å·æ£€æµ‹é»˜è®¤å‹¾é€‰ <strong>15mã€1hã€4hã€24h</strong>ï¼ˆä¸ç­–ç•¥å†³ç­–ä¸€è‡´ï¼‰ï¼›
        è‡ªåŠ¨æ£€æµ‹é—´éš”å»ºè®® <strong>10 åˆ†é’Ÿ</strong>ï¼›é‡ç‚¹å…³æ³¨å„å‘¨æœŸ SS/BS ä¸ã€ŒåŠ¨ä½œã€ã€ŒåŸå› ã€åˆ—ï¼Œå¤šç©ºåˆ†æ­§æ—¶æ˜¾ç¤ºã€Œå¤šç©ºåˆ†æ­§-è§‚æœ›ã€ã€‚
        <br><strong>v4 å…³é”®å˜åŒ–</strong>ï¼šåšç©ºé—¨æ§›ä» 35 é™è‡³ 25ï¼Œè¿½è¸ªæ­¢æŸæ›´ç´§ï¼ˆ15%/12%ï¼‰ï¼Œæ­¢æŸæ›´å®½ï¼ˆ-25%/-10%ï¼‰ã€‚
    </div>
</div>
{% endblock %}
