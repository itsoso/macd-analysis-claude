{% extends "base.html" %}
{% block title %}å½“å‰æœ€ä¼˜ç­–ç•¥(v4.2) - æŠ€æœ¯åˆ†æå¹³å°{% endblock %}

{% block content %}
<style>
    .strategy-hero {
        background: linear-gradient(135deg, rgba(74,158,255,0.12), rgba(168,85,247,0.08));
        border: 1px solid var(--border);
        border-radius: 16px;
        padding: 28px 32px;
        margin-bottom: 28px;
    }
    .strategy-hero h1 { font-size: 26px; font-weight: 700; margin-bottom: 8px; }
    .strategy-hero .tagline { font-size: 14px; color: var(--text-secondary); margin-bottom: 20px; }
    .strategy-meta {
        display: flex; flex-wrap: wrap; gap: 12px;
    }
    .strategy-meta .badge {
        padding: 6px 12px; border-radius: 8px; font-size: 12px; font-weight: 600;
    }
    .strategy-meta .badge.blue { background: rgba(74,158,255,0.2); color: var(--accent-blue); }
    .strategy-meta .badge.green { background: rgba(0,214,143,0.2); color: var(--accent-green); }
    .strategy-meta .badge.purple { background: rgba(168,85,247,0.2); color: var(--accent-purple); }
    .strategy-meta .badge.yellow { background: rgba(255,170,0,0.2); color: var(--accent-yellow); }

    .section h3 {
        font-size: 16px; font-weight: 600; margin-bottom: 12px;
        display: flex; align-items: center; gap: 8px;
    }
    .section { margin-bottom: 24px; }
    .section ul { margin: 0; padding-left: 20px; color: var(--text-secondary); font-size: 14px; line-height: 1.8; }
    .section .param-table {
        width: 100%; border-collapse: collapse; font-size: 13px; margin-top: 8px;
    }
    .section .param-table th, .section .param-table td {
        text-align: left; padding: 8px 12px; border-bottom: 1px solid var(--border);
    }
    .section .param-table th { color: var(--text-muted); font-weight: 600; }
    .section .param-table code { background: var(--bg-secondary); padding: 2px 6px; border-radius: 4px; }
    .monitor-tip {
        background: rgba(255,170,0,0.1); border: 1px solid rgba(255,170,0,0.3);
        border-radius: 10px; padding: 16px; margin-top: 16px; font-size: 13px; color: var(--text-secondary);
    }
    .monitor-tip strong { color: var(--accent-yellow); }
    .evolution-timeline {
        display: flex; flex-direction: column; gap: 0; margin: 16px 0; font-size: 13px;
    }
    .evolution-item {
        display: flex; gap: 16px; padding: 12px 0;
        border-left: 2px solid var(--border); margin-left: 12px; padding-left: 20px;
        position: relative; color: var(--text-secondary); line-height: 1.6;
    }
    .evolution-item::before {
        content: ''; position: absolute; left: -6px; top: 16px;
        width: 10px; height: 10px; border-radius: 50%; background: var(--border);
    }
    .evolution-item.active { border-left-color: var(--accent-blue); }
    .evolution-item.active::before { background: var(--accent-blue); box-shadow: 0 0 8px rgba(74,158,255,0.5); }
    .evolution-tag { font-weight: 600; color: var(--text-primary); min-width: 32px; }
    .ab-result { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 12px; }
    .ab-card {
        background: var(--bg-secondary); border: 1px solid var(--border); border-radius: 8px;
        padding: 12px; font-size: 12px; color: var(--text-secondary);
    }
    .ab-card .ab-label { font-weight: 600; color: var(--text-primary); margin-bottom: 4px; }
    .ab-card .ab-verdict { font-weight: 600; margin-top: 4px; }
    .ab-card .ab-verdict.keep { color: var(--accent-green); }
    .ab-card .ab-verdict.drop { color: var(--accent-red); }
</style>

<div class="strategy-hero">
    <h1>ğŸ“Œ å½“å‰æœ€ä¼˜ç­–ç•¥ï¼ˆv4.2 â€” SPOT_SELL å°¾éƒ¨æ”¶æ•›ä¼˜åŒ–ï¼‰</h1>
    <p class="tagline">å…­ä¹¦èåˆ Â· å¤šå‘¨æœŸè”åˆå†³ç­– Â· ETH/USDT Â· ä¸é€æ—¥å›æµ‹ Run#38 ä¸€è‡´ Â· ç¬¬å…­è½®A/BéªŒè¯</p>
    <div class="strategy-meta">
        <span class="badge blue">å†³ç­–å‘¨æœŸ 15m / 1h / 4h / 24h</span>
        <span class="badge green">åˆ†æ®µæ­¢ç›ˆ v3ï¼ˆ+12% / +25%ï¼‰</span>
        <span class="badge purple">Regime åŠ¨æ€é˜ˆå€¼</span>
        <span class="badge yellow">ç»“æ„åŒ–è½åº“ ss/bs/atr/regime</span>
        <span class="badge orange">SPOT_SELLé«˜SSç¡®è®¤è¿‡æ»¤</span>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ¯ ç­–ç•¥æ¦‚è¦</h3>
    <p style="color: var(--text-secondary); font-size: 14px; line-height: 1.7; margin-bottom: 16px;">
        åŸºäºå…­ç»´èåˆè¯„åˆ†ï¼ˆèƒŒç¦»ã€å‡çº¿ã€èœ¡çƒ›å›¾ã€å¸ƒæ—å¸¦ã€é‡ä»·ã€KDJï¼‰åœ¨å¤šä¸ªæ—¶é—´æ¡†æ¶ä¸Šå¹¶è¡Œè®¡ç®—<strong>å–å‡ºåˆ†ï¼ˆSSï¼‰</strong>ä¸<strong>ä¹°å…¥åˆ†ï¼ˆBSï¼‰</strong>ï¼Œ
        é€šè¿‡å¤šå‘¨æœŸå…±è¯†ä¸è¶‹åŠ¿/Regime åŠ¨æ€é˜ˆå€¼å†³å®šå¼€å¹³ä»“ã€‚v4.2 åœ¨ v4 åŸºç¡€ä¸Šï¼Œé€šè¿‡ç¬¬å…­è½® 10 ç»„ A/B éªŒè¯ï¼š
        (1) å¯ç”¨ SPOT_SELL é«˜ SS ç¡®è®¤è¿‡æ»¤ â†’ pPF 1.92â†’1.95ï¼Œtrend regime pPF 1.30â†’1.47ï¼›
        (2) éªŒè¯ç©ºå¤´é—¨æ§/Capæ–¹æ¡ˆå‡ä¸å€¼å¾—ï¼ˆä»£ä»·>40ppæ”¶ç›Šï¼‰ã€‚
    </p>
    <ul>
        <li><strong>å¼€ç©º</strong>ï¼šSS â‰¥ 25ï¼ˆv4 é™ä½é—¨æ§›ï¼‰ï¼Œä¸”å–æ–¹ä¼˜åŠ¿æ»¡è¶³ dominanceï¼Œæ— å†²çªã€é£æ§ä¸å¾®ç»“æ„æœªæ‹¦æˆªã€‚</li>
        <li><strong>å¼€å¤š</strong>ï¼šBS â‰¥ 30ï¼ˆlong_thresholdï¼‰ï¼Œä¸”ä¹°æ–¹ä¼˜åŠ¿æ»¡è¶³ dominanceã€‚</li>
        <li><strong>å–å‡ºç°è´§</strong>ï¼šSS â‰¥ 18ï¼ˆsell_thresholdï¼‰ï¼Œå†·å´ä¸è¶‹åŠ¿åº•çº¿æ»¡è¶³ã€‚<strong style="color:#e67e22;">v4.2ï¼šSSâ‰¥100 æ—¶éœ€é¢å¤–ç¡®è®¤ï¼ˆEMA/é‡/ATR è‡³å°‘3é¡¹æ»¡è¶³ï¼‰</strong></li>
        <li><strong>å›ºå®šæ­¢æŸ</strong>ï¼šåšç©º -25%ï¼Œåšå¤š -10%ï¼›ç¡¬æ–­è·¯å™¨ -30%ï¼ˆA/BéªŒè¯é›¶ä»£ä»·é˜²è·³ç©ºï¼‰ï¼›ATR åŠ¨æ€æ­¢æŸå…³é—­ï¼ˆA/B è¯æ˜å¯¹ ETH æ— æ•ˆï¼‰ã€‚</li>
        <li><strong>åˆ†æ®µæ­¢ç›ˆ v3</strong>ï¼šåšç©º TP1 åœ¨ +12% å¹³ 30%ï¼ŒTP2 åœ¨ +25% å†å¹³ 30%ï¼›åšå¤šåŒç†ã€‚</li>
        <li><strong>è¿½è¸ªæ­¢æŸ</strong>ï¼šåšç©º trailing 15%ï¼Œåšå¤š 12%ï¼Œå›æ’¤æ¯” 50%ã€‚</li>
        <li><strong>ç»“æ„åŒ–è§‚æµ‹</strong>ï¼šæ¯ç¬”äº¤æ˜“è‡ªåŠ¨è®°å½• ss/bs/atr_pct/regime_label åˆ° DBï¼Œæ”¯æŒç²¾ç¡®å½’å› åˆ†æã€‚</li>
    </ul>
</div>

<div class="card">
    <h3 class="card-title">ğŸ“Š å›æµ‹å‚è€ƒï¼ˆRun#38ï¼Œ2025-01ï½2026-01ï¼‰</h3>
    <div class="stats-grid">
        <div class="stat-card">
            <div class="stat-label">ç­–ç•¥æ”¶ç›Š</div>
            <div class="stat-value positive">+850.83%</div>
            <div class="stat-note">vs ä¹°å…¥æŒæœ‰ -13.55%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">Alpha</div>
            <div class="stat-value positive">+864.38%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">æœ€å¤§å›æ’¤</div>
            <div class="stat-value" style="color: var(--accent-yellow);">-8.48%</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">åˆçº¦ PF</div>
            <div class="stat-value">1.07</div>
            <div class="stat-note">ä»… CLOSE_LONG/SHORT</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">ç»„åˆ PF</div>
            <div class="stat-value positive">1.95</div>
            <div class="stat-note">å« PARTIAL_TP / SPOT_SELL</div>
        </div>
        <div class="stat-card">
            <div class="stat-label">èƒœç‡</div>
            <div class="stat-value">62.9%</div>
            <div class="stat-note">248 æ¬¡å¹³ä»“</div>
        </div>
    </div>
    <h4 style="font-size: 14px; font-weight: 600; margin-bottom: 8px; color: var(--text-primary);">Regime åˆ†æ®µè¡¨ç°</h4>
    <table class="param-table">
        <thead><tr><th>Regime</th><th>ç¬”æ•°</th><th>å‡€ PnL</th><th>pPF</th><th>è¯´æ˜</th></tr></thead>
        <tbody>
            <tr><td>neutral</td><td>272</td><td class="pnl-pos">+$360,997</td><td>2.78</td><td>ä¸»è¦åˆ©æ¶¦æ¥æº</td></tr>
            <tr><td>trend</td><td>140</td><td class="pnl-pos">+$123,789</td><td><strong>1.47</strong></td><td>v4.2 é«˜SSç¡®è®¤ â†’ pPFä»1.30â†‘1.47</td></tr>
            <tr><td>high_vol</td><td>44</td><td class="pnl-pos">+$95,028</td><td>3.81</td><td>é«˜æ³¢åŠ¨è¡Œæƒ…è·åˆ©ä¸°åš</td></tr>
            <tr><td>low_vol_trend</td><td>62</td><td class="pnl-pos">+$2,253</td><td>1.02</td><td>ä½æ³¢åŠ¨è¶‹åŠ¿è¿‘å¹³ï¼Œæ­¢æŸé›†ä¸­åŒº</td></tr>
            <tr><td>high_vol_choppy</td><td>5</td><td class="pnl-pos">+$3,999</td><td>5.32</td><td>ç½•è§çŠ¶æ€</td></tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h3 class="card-title">âš™ï¸ å…³é”®å‚æ•°ï¼ˆv4.2 â€” ç¬¬å…­è½®A/BéªŒè¯åï¼‰</h3>
    <table class="param-table">
        <thead>
            <tr><th>å‚æ•°</th><th>v4.2 å€¼</th><th>v4 å€¼</th><th>å˜åŒ–è¯´æ˜</th></tr>
        </thead>
        <tbody>
            <tr><td><code>short_threshold</code></td><td>25</td><td>25</td><td>ä¸å˜</td></tr>
            <tr><td><code>short_sl</code></td><td>-25%</td><td>-25%</td><td>ä¸å˜</td></tr>
            <tr><td><code>short_tp</code></td><td>60%</td><td>60%</td><td>ä¸å˜</td></tr>
            <tr><td><code>long_sl</code></td><td>-10%</td><td>-10%</td><td>ä¸å˜</td></tr>
            <tr><td><code>short_trail / long_trail</code></td><td>15% / 12%</td><td>15% / 12%</td><td>ä¸å˜</td></tr>
            <tr><td><code>trail_pullback</code></td><td>50%</td><td>50%</td><td>ä¸å˜</td></tr>
            <tr><td><code>hard_stop_loss</code></td><td>-30%</td><td>-30%</td><td>ç¡¬æ–­è·¯å™¨(A/BéªŒè¯é›¶ä»£ä»·é˜²è·³ç©º)</td></tr>
            <tr style="background:rgba(46,204,113,0.08)"><td><code>use_spot_sell_confirm</code></td><td><strong style="color:#27ae60;">å¼€</strong></td><td>å…³</td><td><strong>v4.2æ–°</strong>ï¼šSSâ‰¥100æ—¶éœ€EMA/é‡/ATRä¸‰é‡ç¡®è®¤</td></tr>
            <tr style="background:rgba(46,204,113,0.08)"><td><code>spot_sell_confirm_ss</code></td><td><strong style="color:#27ae60;">100</strong></td><td>50</td><td>ä»…è¿‡æ»¤æç«¯é«˜SSå–å‡º(trend+SSâ‰¥100æ›¾æ‹–ç´¯-$129k)</td></tr>
            <tr style="background:rgba(46,204,113,0.08)"><td><code>spot_sell_confirm_min</code></td><td><strong style="color:#27ae60;">3</strong></td><td>2</td><td>è¦æ±‚å…¨éƒ¨3é¡¹ç¡®è®¤(æ›´ä¸¥æ ¼)</td></tr>
            <tr><td><code>use_regime_short_gate</code></td><td>å…³</td><td>å…³</td><td>ç¬¬å…­è½®éªŒè¯ï¼šgate_add 25/35å‡ä¸å€¼(ä»£ä»·>40pp)</td></tr>
            <tr><td><code>use_spot_sell_cap</code></td><td>å…³</td><td>å…³</td><td>ç¬¬å…­è½®éªŒè¯ï¼šcap20%æŸæ”¶ç›Š-71pp</td></tr>
            <tr><td><code>spot_sell_regime_block</code></td><td>ç©º</td><td>ç©º</td><td>å¤‡é€‰ï¼š='trend'å¯è¾¾pPF 2.25/DD -7.89%ä½†-37ppæ”¶ç›Š</td></tr>
        </tbody>
    </table>
</div>

<div class="card">
    <h3 class="card-title">ğŸ”¬ ç¬¬å…­è½® A/B æ¶ˆèéªŒè¯ï¼ˆv4â†’v4.2ï¼‰</h3>
    <p style="color: var(--text-secondary); font-size: 13px; margin-bottom: 12px;">
        10 ç»„æ¶ˆèæµ‹è¯•ï¼Œèšç„¦ SPOT_SELL å°¾éƒ¨é£æ§ + ç©ºå¤´é—¨æ§å¼ºåŒ–ï¼š
    </p>
    <div class="ab-result">
        <div class="ab-card">
            <div class="ab-label">B: SSâ‰¥100 ç¡®è®¤è¿‡æ»¤</div>
            <p>pPF 1.92â†’<strong>1.95</strong>ï¼Œtrend pPF 1.30â†’1.47ï¼Œæ”¶ç›Šä»…-8pp</p>
            <div class="ab-verdict keep">å¯ç”¨ â€” å‡ ä¹é›¶ä»£ä»·è¿‡æ»¤è¶‹åŠ¿ä¸­é«˜SSè¯¯æ€</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">F: è¶‹åŠ¿ç¦å–(å¤‡é€‰)</div>
            <p>pPF 1.92â†’<strong>2.25</strong>ï¼ŒDD -7.89%ï¼ˆæœ€ä¼˜ï¼‰ï¼Œä½†æ”¶ç›Š-37pp</p>
            <div class="ab-verdict keep">å¤‡é€‰ â€” é£é™©æ”¶æ•›æœ€ä¼˜(spot_sell_regime_block='trend')</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">D: cap20% æ¯”ä¾‹ä¸Šé™</div>
            <p>æ”¶ç›Š-71ppï¼ŒSPOT_SELL PnL ä» $335k é™è‡³ $252k</p>
            <div class="ab-verdict drop">å…³é—­ â€” å‰Šå¼±æ ¸å¿ƒæ”¶ç›Š</div>
        </div>
        <div class="ab-card">
            <div class="ab-label">G/H: ç©ºå¤´é—¨æ§+25/+35</div>
            <p>gate_add 25: -41pp; gate_add 35: -43pp; neutralæ‰©å±•: -66pp</p>
            <div class="ab-verdict drop">å…³é—­ â€” ä»»ä½•å¼ºåº¦å‡ä»£ä»·è¿‡å¤§</div>
        </div>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ“ˆ ç­–ç•¥æ¼”è¿›è·¯çº¿</h3>
    <div class="evolution-timeline">
        <div class="evolution-item">
            <span class="evolution-tag">v1</span>
            <div>åŸºç¡€å…­ä¹¦èåˆç­–ç•¥ï¼Œå›ºå®šé˜ˆå€¼ + å›ºå®šæ­¢ç›ˆæ­¢æŸã€‚æ”¶ç›Š +600%ã€‚</div>
        </div>
        <div class="evolution-item">
            <span class="evolution-tag">v2</span>
            <div>å¼•å…¥å¤šå‘¨æœŸå…±è¯†ã€Regime åŠ¨æ€é˜ˆå€¼ã€å¾®ç»“æ„è¿‡æ»¤ã€‚æ”¶ç›Š +600%ï¼Œå›æ’¤æ”¹å–„ã€‚</div>
        </div>
        <div class="evolution-item">
            <span class="evolution-tag">v3</span>
            <div>æ—©æœŸåˆ†æ®µé”åˆ©ï¼ˆ+12%/+25%ï¼‰ï¼Œæ”¶ç›Šè·ƒå‡è‡³ +806%ï¼Œå›æ’¤ -10.26%ã€‚</div>
        </div>
        <div class="evolution-item">
            <span class="evolution-tag">v4</span>
            <div>param_sweep 33 ç»„ç³»ç»Ÿæ€§ä¼˜åŒ–ï¼šçŸ­é˜ˆå€¼é™è‡³ 25ã€æ­¢æŸæ”¾å®½è‡³ -25%ã€è¿½è¸ªæ”¶ç´§è‡³ 15%/12%ã€‚
                æ”¶ç›Š +859%ï¼ˆ+53ppï¼‰ï¼Œå›æ’¤ -8.48%ï¼ˆæ”¹å–„ 1.78ppï¼‰ã€‚ç»“æ„åŒ–è§‚æµ‹é“¾è·¯è½åº“ã€‚</div>
        </div>
        <div class="evolution-item active">
            <span class="evolution-tag">v4.2</span>
            <div>ç¬¬å…­è½® 10 ç»„ A/B éªŒè¯ï¼šå¯ç”¨é«˜ SS ç¡®è®¤è¿‡æ»¤ï¼ˆSSâ‰¥100 éœ€ EMA/é‡/ATR ä¸‰é‡ç¡®è®¤ï¼‰ã€‚
                æ”¶ç›Š +851%ï¼ˆ-8ppï¼‰ï¼Œ<strong>pPF 1.95</strong>ï¼ˆ+1.6%ï¼‰ï¼Œ<strong>trend regime pPF 1.47</strong>ï¼ˆ+13%ï¼‰ã€‚
                ç¡¬æ–­è·¯å™¨ -30% é˜²è·³ç©ºã€‚2024å¹´OOSéªŒè¯ Alpha +61%ï¼Œæ— è¿‡æ‹Ÿåˆã€‚</div>
        </div>
    </div>
</div>

<div class="card">
    <h3 class="card-title">ğŸ”— ç›¸å…³é¡µé¢</h3>
    <p style="color: var(--text-secondary); font-size: 14px;">
        <a href="/strategy/live-control" style="color: var(--accent-blue);">å®ç›˜æ§åˆ¶é¢æ¿</a> Â·
        <a href="/strategy/multi-tf-daily" style="color: var(--accent-blue);">å¤šå‘¨æœŸÂ·é€æ—¥ç›ˆäº</a> Â·
        <a href="/strategy/multi-tf-deep-dive" style="color: var(--accent-blue);">å¤šå‘¨æœŸè”åˆå†³ç­–Â·ä»£ç è¯¦è§£</a> Â·
        <a href="/strategy/multi-tf-date-range-report" style="color: var(--accent-blue);">å¤šå‘¨æœŸåŒºé—´å›æµ‹(DB)</a>
    </p>
    <div class="monitor-tip">
        <strong>å®ç›˜æ§åˆ¶é¢æ¿å»ºè®®</strong>ï¼šå¤šå‘¨æœŸä¿¡å·æ£€æµ‹é»˜è®¤å‹¾é€‰ <strong>15mã€1hã€4hã€24h</strong>ï¼ˆä¸ç­–ç•¥å†³ç­–ä¸€è‡´ï¼‰ï¼›
        è‡ªåŠ¨æ£€æµ‹é—´éš”å»ºè®® <strong>10 åˆ†é’Ÿ</strong>ï¼›é‡ç‚¹å…³æ³¨å„å‘¨æœŸ SS/BS ä¸ã€ŒåŠ¨ä½œã€ã€ŒåŸå› ã€åˆ—ï¼Œå¤šç©ºåˆ†æ­§æ—¶æ˜¾ç¤ºã€Œå¤šç©ºåˆ†æ­§-è§‚æœ›ã€ã€‚
        <br><strong>v4.2 å…³é”®å˜åŒ–</strong>ï¼šSSâ‰¥100 æ—¶å¯ç”¨ EMA/é‡/ATR ä¸‰é‡ç¡®è®¤è¿‡æ»¤ï¼ˆtrend+SSâ‰¥100 æ›¾æ‹–ç´¯ -$129kï¼‰ã€‚
        å¤‡é€‰"é£é™©æ”¶æ•›æ¨¡å¼"ï¼šspot_sell_regime_block='trend' â†’ pPF 2.25 / DD -7.89%ï¼ˆæ”¶ç›Š-37ppï¼‰ã€‚
    </div>
</div>
{% endblock %}
